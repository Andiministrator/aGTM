window.aGTM=window.aGTM||{},aGTM.d=aGTM.d||{config:!1,init:!1,fired:!1},aGTM.f=aGTM.f||{},aGTM.l=aGTM.l||[],aGTM.n=aGTM.n||{},aGTM.f.consent_check=function(n){if("string"!=typeof n||"init"!=n&&"update"!=n)return"function"==typeof aGTM.f.log&&aGTM.f.log("e10",{action:n}),!1;if(aGTM.d.consent=aGTM.d.consent||{},"init"==n&&aGTM.d.consent.hasResponse)return!0;if("object"!=typeof Optanon||"function"!=typeof Optanon.GetDomainData)return!1;var t=Optanon.GetDomainData();if("object"!=typeof t.ConsentIntegrationData||"object"!=typeof t.ConsentIntegrationData.consentPayload||"object"!=typeof t.ConsentIntegrationData.consentPayload.customPayload||"object"!=typeof t.ConsentIntegrationData.consentPayload.purposes||"object"!=typeof t.ConsentModel||"string"!=typeof t.ConsentModel.Name)return!1;var e=t.ConsentIntegrationData.consentPayload;if("number"!=typeof e.customPayload.Interaction)return!1;if(aGTM.d.consent.interactions=e.customPayload.Interaction,"object"!=typeof e.dsDataElements||"string"!=typeof e.dsDataElements.Country)return!1;aGTM.d.consent.consent_model=t.ConsentModel.Name,"string"==typeof t.cctId&&(aGTM.d.consent.consent_id=t.cctId),"object"==typeof e.dsDataElements&&"string"==typeof e.dsDataElements.InteractionType&&(aGTM.d.consent.interaction_type=e.dsDataElements.InteractionType),"object"==typeof e.dsDataElements&&"string"==typeof e.dsDataElements.Country&&(aGTM.d.consent.country=e.dsDataElements.Country);for(var o={},a=0,s={},r=0,p=0,c={},i=0;i<e.purposes.length;i++)c[e.purposes[i].Id]=e.purposes[i].TransactionType;for(i=0;i<t.Groups.length;i++)"string"==typeof c[t.Groups[i].PurposeId]&&("NO_CHOICE"==c[t.Groups[i].PurposeId]&&(s[t.Groups[i].OptanonGroupId]=t.Groups[i].GroupName.replace(/[^\w\d _-]+/g,""),r++),"NO_CHOICE"!=c[t.Groups[i].PurposeId]&&"CONFIRMED"!=c[t.Groups[i].PurposeId]||(o[t.Groups[i].OptanonGroupId]=t.Groups[i].GroupName.replace(/[^\w\d _-]+/g,""),a++),p++);var d=[],f=[];for(k in o)d.push(k),f.push(o[k]);return aGTM.d.consent.purposeIDs=","+d.join(",")+",",aGTM.d.consent.purposes=","+f.join(",")+",",aGTM.d.consent.interaction_type?aGTM.d.consent.feedback=trConfig.cmp.interaction_type:aGTM.d.consent.feedback=p==r?"No OptIn Categories available":a==p?"Consent full accepted":a==r?"Consent declined":a<p?"Consent partially accepted":"Consent given",aGTM.d.consent.hasResponse=!0,"function"==typeof aGTM.f.log&&aGTM.f.log("m2",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};