___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "CLIENT",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "aGTM",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "aGTM Client for serverside Google Tag Manager",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "GROUP",
    "name": "aGTMid",
    "displayName": "Use different aGTM Setups using ID\u0027s",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "subParams": [
      {
        "type": "PARAM_TABLE",
        "name": "ids",
        "displayName": "Allowed (a)GTM ID(s)",
        "paramTableColumns": [
          {
            "param": {
              "type": "TEXT",
              "name": "id",
              "displayName": "(a)GTM ID",
              "simpleValueType": true,
              "notSetText": "You need to setup an ID. Otherwise delete this row.",
              "help": "Set an ID to load this aGTM only for special uses.\u003cbr /\u003e You can use any sting, even a GTM ID, like GTM-XYZ123, but it won\u0027t have an effect for the GTM Setup.",
              "valueHint": "GTM-XYZ123"
            },
            "isUnique": true
          }
        ],
        "help": "Set allowed IDs to load this aGTM only for special uses.\u003cbr /\u003e You can use any sting, even a GTM ID, like GTM-XYZ123, but it won\u0027t have an effect for the GTM Setup.\u003cBR /\u003e Leave it blank if the aGTM Setup should alway load."
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "aGTMsetup",
    "displayName": "GTM Container Setup",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "gtm",
        "displayName": "",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "GTM Container ID",
            "name": "gtm_id",
            "type": "TEXT",
            "valueHint": "GTM-XYZ123",
            "isUnique": true
          },
          {
            "defaultValue": true,
            "displayName": "Consent Check",
            "name": "gtm_consent",
            "type": "SELECT",
            "selectItems": [
              {
                "value": true,
                "displayValue": "Yes"
              },
              {
                "value": false,
                "displayValue": "No"
              }
            ]
          },
          {
            "defaultValue": "",
            "displayName": "Environment String",
            "name": "gtm_env",
            "type": "TEXT",
            "valueHint": "Example: \u0027\u0026gtm_auth\u003dABC123xyz\u0026gtm_preview\u003denv-1\u0026gtm_cookies_win\u003dx\u0027"
          },
          {
            "defaultValue": "https://www.googletagmanager.com/gtm.js",
            "displayName": "Container URL",
            "name": "gtm_url",
            "type": "TEXT",
            "valueHint": "If you use an own url to the GTM (e.g. using the serverside Google Tag Manager), you can set your URL here. Leave it blank if you don\u0027t know what this means. If this option is not set (or if it is empty) the standard GTM URL will be used (https://www.googletagmanager.com/gtm.js)."
          }
        ],
        "newRowButtonText": "Add a GTM Container",
        "notSetText": "Please setup at least one GHTM Container.\u003cbr/\u003e Otherwise no GTM Container will load (through aGTM) ...",
        "help": "Configure the GTM Container(s) that should fire ..."
      },
      {
        "type": "LABEL",
        "name": "gtm_help",
        "displayName": "Read the \u003ca href\u003d\"https://github.com/Andiministrator/aGTM?tab\u003dreadme-ov-file#gtm\"\u003eDocumentation Chapter\u003c/a\u003e for more information."
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "aGTMcmp",
    "displayName": "Consent Check",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "SELECT",
        "name": "cmp",
        "displayName": "Used CMP (Consent Tool)",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "aGTM.f.consent_check\u003dfunction(o){if(\"string\"!\u003dtypeof o||\"init\"!\u003do\u0026\u0026\"update\"!\u003do)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:o}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003do\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"\u003d\u003dtypeof BorlabsCookie\u0026\u0026\"function\"\u003d\u003dtypeof BorlabsCookie.getCookie){if(\"object\"!\u003dtypeof borlabsCookieConfig||\"object\"!\u003dtypeof borlabsCookieConfig.cookies)return!1;var e\u003dborlabsCookieConfig.cookies;if(\"object\"!\u003dtypeof BorlabsCookie||\"function\"!\u003dtypeof BorlabsCookie.getCookie)return!1;var n\u003dBorlabsCookie.getCookie()}else{if(\"object\"!\u003dtypeof borlabsCookieConfig||\"object\"!\u003dtypeof borlabsCookieConfig.services)return!1;e\u003dborlabsCookieConfig.services;if(\"object\"!\u003dtypeof BorlabsCookie)return!1;if(\"object\"!\u003dtypeof BorlabsCookie.Cookie._pluginCookie)return!1;if(\"string\"!\u003dtypeof(n\u003dBorlabsCookie.Cookie._pluginCookie).expires||!n.expires)return!1}if(\"object\"!\u003dtypeof n||\"object\"!\u003dtypeof n.consents)return!1;var t\u003dn.consents;\"string\"\u003d\u003dtypeof n.uid\u0026\u0026(aGTM.d.consent.consent_id\u003dn.uid);var i\u003d[],s\u003d[],r\u003d[],a\u003d[],f\u003d0;for(var c in e)if(\"string\"\u003d\u003dtypeof c){s.push(c);for(var l\u003d0;l\u003cc.length;l++)\"string\"\u003d\u003dtypeof c[l]\u0026\u0026c[l]\u0026\u0026a.push(c[l])}for(var c in t)if(\"string\"\u003d\u003dtypeof c){i.push(c),\"essential\"\u003d\u003dc\u0026\u00260;var p\u003dt[c];for(l\u003d0;l\u003cp.length;l++)\"string\"\u003d\u003dtypeof p[l]\u0026\u0026p[l]\u0026\u0026r.push(p[l]),\"essential\"\u003d\u003dc\u0026\u0026f++}i.length\u003e0\u0026\u0026(aGTM.d.consent.purposes\u003d\",\"+i.join(\",\")+\",\"),r.length\u003e0\u0026\u0026(aGTM.d.consent.services\u003d\",\"+r.join(\",\")+\",\");var g\u003d\"No Services\";r.length\u003e0\u0026\u0026r.length\u003d\u003da.length?g\u003d\"Consent full accepted\":r.length\u003e0\u0026\u0026r.length\u003d\u003df?g\u003d\"Consent declined\":r.length\u003e0\u0026\u0026r.length\u003ca.length?g\u003d\"Consent partially accepted\":r.length\u003e0\u0026\u0026(g\u003d\"Consent given by user\"),aGTM.d.consent.feedback\u003dg,aGTM.d.consent.hasResponse\u003d!0};",
            "displayValue": "Borlabs v2"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof borlabsCookieConfig||\"object\"!\u003dtypeof borlabsCookieConfig.serviceGroups)return!1;var n\u003dborlabsCookieConfig.serviceGroups;if(\"object\"!\u003dtypeof BorlabsCookie)return!1;if(\"object\"!\u003dtypeof BorlabsCookie.Cookie._pluginCookie)return!1;var o\u003dBorlabsCookie.Cookie._pluginCookie;if(\"string\"!\u003dtypeof o.expires||!o.expires)return!1;if(\"object\"!\u003dtypeof o||\"object\"!\u003dtypeof o.consents)return!1;var s\u003do.consents;\"string\"\u003d\u003dtypeof o.uid\u0026\u0026(aGTM.d.consent.consent_id\u003do.uid);var t\u003d[],r\u003d[],i\u003d0,a\u003d[],l\u003d[],c\u003d0;for(var f in n)if(\"string\"\u003d\u003dtypeof f\u0026\u0026(r.push(f),n[f].serviceIds,n[f].serviceIds\u0026\u0026n[f].serviceIds.length\u003e0))for(var p\u003dn[f].serviceIds,g\u003d0;g\u003cp.length;g++)\"string\"\u003d\u003dtypeof p[g]\u0026\u0026p[g]\u0026\u0026l.push(p[g]);for(var f in s)if(\"string\"\u003d\u003dtypeof f){t.push(f),\"essential\"\u003d\u003df\u0026\u0026i++;var b\u003ds[f];for(g\u003d0;g\u003cb.length;g++)\"string\"\u003d\u003dtypeof b[g]\u0026\u0026b[g]\u0026\u0026a.push(b[g]),\"essential\"\u003d\u003df\u0026\u0026c++}t.length\u003e0\u0026\u0026(aGTM.d.consent.purposes\u003d\",\"+t.join(\",\")+\",\"),a.length\u003e0\u0026\u0026(aGTM.d.consent.services\u003d\",\"+a.join(\",\")+\",\");var d\u003d\"No Services\";a.length\u003e0\u0026\u0026a.length\u003d\u003dl.length?d\u003d\"Consent full accepted\":a.length\u003e0\u0026\u0026a.length\u003d\u003dc?d\u003d\"Consent declined\":a.length\u003e0\u0026\u0026a.length\u003cl.length?d\u003d\"Consent partially accepted\":a.length\u003e0\u0026\u0026(d\u003d\"Consent given by user\"),aGTM.d.consent.feedback\u003dd;var u\u003dJSON.parse(JSON.stringify(aGTM.d.consent));return u.borlabs_purposes_configured\u003dr,u.borlabs_services_configured\u003dl,u.borlabs_purposes_essential\u003di,u.borlabs_purposes_all\u003dr.length,u.borlabs_purposes_consented\u003dt.length,u.borlabs_services_essential\u003dc,u.borlabs_services_all\u003dl.length,u.borlabs_services_consented\u003da.length,window.borlabs_aData\u003du,aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Borlabs v3"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof CCM||\"boolean\"!\u003dtypeof CCM.consent)return!1;var n\u003dCCM;if(\"object\"!\u003dtypeof n.acceptedEmbeddings)return!1;if(!n.consent\u0026\u0026n.consentRequired)return!1;for(var t\u003d[],o\u003dnull!\u003dn\u0026\u0026\"object\"\u003d\u003dtypeof n.acceptedEmbeddings\u0026\u0026null!\u003dn.acceptedEmbeddings?n.acceptedEmbeddings:{},a\u003d0;a\u003co.length;a++)\"string\"!\u003dtypeof o[a].name\u0026\u0026\"\"!\u003do[a].name||t.push(o[a].name.replace(\",\",\"\"));t.length\u003e0\u0026\u0026(t.sort(),aGTM.d.consent.services\u003d\",\"+t.join(\",\")+\",\");var c\u003d\"Consent available\";return c\u003d\"boolean\"\u003d\u003dtypeof n.fullConsentGiven\u0026\u0026!0\u003d\u003d\u003dn.fullConsentGiven?\"Consent full accepted\":\"Consent (partially or full) declined\",aGTM.d.consent.feedback\u003dc,\"string\"\u003d\u003dtypeof n.ucid\u0026\u0026(aGTM.d.consent.consent_id\u003dn.ucid),aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "CCM19"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(n){if(\"string\"!\u003dtypeof n||\"init\"!\u003dn\u0026\u0026\"update\"!\u003dn)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:n}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},aGTM.d.consent.req_ctr\u003daGTM.d.consent.req_ctr||0,aGTM.d.consent.blocked\u003d\"boolean\"\u003d\u003dtypeof aGTM.d.consent.blocked\u0026\u0026aGTM.d.consent.blocked,\"init\"\u003d\u003dn\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof Clickskeks||\"function\"!\u003dtypeof Clickskeks.getCurrentAllowedConfig)return!1;var e\u003dClickskeks.getCurrentAllowedConfig(),t\u003d[],o\u003d0;for(var a in e)e[a]\u0026\u0026t.push(a),o++;if(!o)return!1;aGTM.d.consent.purposes\u003d\",\"+t.join(\",\")+\",\";var c\u003d\"Consent available\";return 0\u003d\u003do?c\u003d\"Consent declined\":o\u003d\u003dt.length?c\u003d\"Consent full accepted\":o\u003et.length\u0026\u0026(c\u003d\"Consent partially accepted\"),aGTM.d.consent.feedback\u003dc,aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Clickkeks"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},aGTM.d.consent.req_ctr\u003daGTM.d.consent.req_ctr||0,aGTM.d.consent.blocked\u003d\"boolean\"\u003d\u003dtypeof aGTM.d.consent.blocked\u0026\u0026aGTM.d.consent.blocked,\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"function\"!\u003dtypeof __cmp)return!(!aGTM.d.consent.blocked||!aGTM.d.consent.hasResponse)||(10\u003d\u003daGTM.d.consent.req_ctr++\u0026\u0026fetch(\"https://cdn.consentmanager.net/delivery/1x1.gif\").catch((function(e){aGTM.d.consent.blocked\u003d!0,aGTM.d.consent.feedback\u003d\"CMP is blocked\",aGTM.d.consent.hasResponse\u003d!0})),aGTM.d.consent.blocked);var n\u003d__cmp(\"getCMPData\");if(\"object\"!\u003dtypeof n)return!1;if(\"boolean\"!\u003dtypeof n.consentExists||!n.consentExists)return!1;if(\"boolean\"!\u003dtypeof n.userChoiceExists||!n.userChoiceExists)return!1;if(\"object\"!\u003dtypeof n.purposeConsents||\"object\"!\u003dtypeof n.purposesList||\"object\"!\u003dtypeof n.purposeLI)return!1;if(\"object\"!\u003dtypeof n.vendorConsents||\"object\"!\u003dtypeof n.vendorsList||\"object\"!\u003dtypeof n.vendorLI)return!1;for(var o\u003d0,s\u003d0,t\u003d[],c\u003d[],r\u003d0;r\u003cn.purposesList.length;r++)s++,n.purposeConsents[n.purposesList[r].id]||n.purposeLI[n.purposesList[r].id]?(c.push(n.purposesList[r].id),t.push(n.purposesList[r].name)):0,n.purposeConsents[n.purposesList[r].id]\u0026\u0026o++;var i\u003d[],a\u003d[];for(r\u003d0;r\u003cn.vendorsList.length;r++)s++,n.vendorConsents[n.vendorsList[r].id]||n.vendorLI[n.vendorsList[r].id]?(a.push(n.vendorsList[r].id),i.push(n.vendorsList[r].name)):0,n.vendorConsents[n.vendorsList[r].id]\u0026\u0026o++;aGTM.d.consent.purposes\u003d\",\"+t.join(\",\")+\",\",aGTM.d.consent.purposeIDs\u003d\",\"+c.join(\",\")+\",\",aGTM.d.consent.vendors\u003d\",\"+i.join(\",\")+\",\",aGTM.d.consent.vendorIDs\u003d\",\"+a.join(\",\")+\",\";var d\u003d\"Consent available\";return s\u003d\u003do?d\u003d\"Consent full accepted\":s\u0026\u0026!o?d\u003d\"Consent declined\":s\u0026\u0026o\u003cs\u0026\u0026(d\u003d\"Consent partially accepted\"),aGTM.d.consent.feedback\u003dd,\"string\"\u003d\u003dtypeof n.consentstring\u0026\u0026(aGTM.d.consent.consent_id\u003dn.consentstring),aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Consentmanager"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(n){if(\"string\"!\u003dtypeof n||\"init\"!\u003dn\u0026\u0026\"update\"!\u003dn)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:n}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003dn\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof Cookiebot)return!1;var e\u003dCookiebot;if(\"boolean\"!\u003dtypeof e.hasResponse||\"object\"!\u003dtypeof e.consent)return!1;if(!e.hasResponse)return!1;var o\u003daGTM.c.purposes?aGTM.c.purposes.split(\",\"):[],t\u003d0,a\u003d0;for(k in e.consent)\"stamp\"!\u003dk\u0026\u0026\"method\"!\u003dk\u0026\u0026\"boolean\"\u003d\u003dtypeof e.consent[k]\u0026\u0026(a++,e.consent[k]\u0026\u0026(t++,o.push(k)));aGTM.d.consent.purposes\u003do.length\u003e0?\",\"+o.join(\",\")+\",\":\"\";var s\u003d\"Consent available\";return 0\u003d\u003da?s\u003d\"No purposes available\":t\u003ca?s\u003d\"Consent (partially or full) declined\":t\u003e\u003da\u0026\u0026(s\u003d\"Consent accepted\"),aGTM.d.consent.feedback\u003ds,\"string\"\u003d\u003dtypeof e.consentID\u0026\u0026(aGTM.d.consent.consent_id\u003de.consentID),aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Cookiebot"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof CookieFirst||\"boolean\"!\u003dtypeof CookieFirst.hasConsented)return!1;var n\u003dCookieFirst;if(\"object\"!\u003dtypeof n.consent||\"object\"!\u003dtypeof n.acceptedServices)return!1;if(!n.hasConsented)return!1;var o\u003d[],t\u003dn.consent?n.consent:{};for(k in t)\"string\"\u003d\u003dtypeof k\u0026\u0026\"boolean\"\u003d\u003dtypeof t[k]\u0026\u0026t[k]\u0026\u0026(o.push(k.replace(\",\",\"\")));var a\u003d[],s\u003dn.acceptedServices?n.acceptedServices:{},i\u003d0,r\u003d0;for(k in s)\"string\"\u003d\u003dtypeof k\u0026\u0026\"boolean\"\u003d\u003dtypeof s[k]\u0026\u0026(r++,s[k]\u0026\u0026(i++,a.push(k.replace(\",\",\"\"))));o.length\u003e0\u0026\u0026(o.sort(),aGTM.d.consent.purposes\u003d\",\"+o.join(\",\")+\",\"),a.length\u003e0\u0026\u0026(a.sort(),aGTM.d.consent.services\u003d\",\"+a.join(\",\")+\",\");var c\u003d\"Consent available\";return r\u003e\u003di?c\u003d\"Consent (partially or full) declined\":r\u003d\u003di\u0026\u0026(c\u003d\"Consent full accepted\"),aGTM.d.consent.feedback\u003dc,\"string\"\u003d\u003dtypeof n.visitorId\u0026\u0026(aGTM.d.consent.consent_id\u003dn.visitorId),aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "CookieFirst"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof klaro||\"function\"!\u003dtypeof klaro.getManager)return!1;var n\u003dklaro.getManager();if(\"boolean\"!\u003dtypeof n.confirmed||!n.confirmed)return!1;if(\"object\"!\u003dtypeof n.config||\"object\"!\u003dtypeof n.config.services)return!1;for(var o\u003d{},t\u003dn.config.services,s\u003d0;s\u003ct.length;s++)if(\"string\"\u003d\u003dtypeof t[s].name){var a\u003d[],r\u003dt[s].name;if(\"object\"\u003d\u003dtypeof t[s].purposes\u0026\u0026\"number\"\u003d\u003dtypeof t[s].purposes.length\u0026\u0026t[s].purposes.length\u003e0){a\u003dt[s].purposes;for(var c\u003d0;c\u003ca.length;c++){var f\u003da[c];\"object\"\u003d\u003dtypeof o[f]?o[f].push(r):o[f]\u003d[r]}}}if(\"object\"!\u003dtypeof n.consents||!n.consents)return!1;var i\u003daGTM.c.purposes?aGTM.c.purposes.split(\",\"):[];for(var p in o){0;var l\u003d!0;for(s\u003d0;s\u003co[p].length;s++){var M\u003do[p];\"boolean\"!\u003dtypeof n.consents[M]||n.consents[M]||(l\u003d!1)}l\u0026\u0026i.push(p)}var G\u003daGTM.c.services?aGTM.c.services.split(\",\"):[],T\u003d0;for(var M in n.consents)T++,\"boolean\"\u003d\u003dtypeof n.consents[M]\u0026\u0026n.consents[M]\u0026\u0026G.push(M);aGTM.d.consent.purposes\u003di.length\u003e0?\",\"+i.join(\",\")+\",\":\"\",aGTM.d.consent.services\u003dG.length\u003e0?\",\"+G.join(\",\")+\",\":\"\";var g\u003d\"Consent available\";return 0\u003d\u003dT?g\u003d\"No services available\":0\u003d\u003dG.length\u0026\u0026T\u003e0?g\u003d\"Consent declined\":G.length\u003d\u003dT?g\u003d\"Consent full accepted\":G.length\u003e0\u0026\u0026G.length\u003cT\u0026\u0026(g\u003d\"Consent partially accepted\"),aGTM.d.consent.feedback\u003dg,aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Klaro!"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;var n\u003d\"co\";n+\u003d\"ok\",n+\u003d\"ie\";var t\u003dnew RegExp(\"cc_\"+n+\"\u003d([^;]+)\");try{var o\u003ddocument,s\u003dt.exec(o[n])}catch(e){}if(void 0\u003d\u003d\u003ds)s\u003d\"\";else\"string\"!\u003dtypeof(s\u003dnull!\u003ds?s[1]:\"\")\u0026\u0026(s\u003ds.toString());if(!s)return g;try{var r\u003dJSON.parse(decodeURIComponent(s))}catch(e){return console.log(\"Error by Consent Check: \"+e.message),!1}if(\"object\"!\u003dtypeof r||\"object\"!\u003dtypeof r.categories||\"object\"!\u003dtypeof r.services)return!1;for(var a\u003d[],c\u003d[],i\u003d0,f\u003d0;f\u003cr.categories.length;f++)\"string\"\u003d\u003dtypeof r.categories[f]\u0026\u0026r.categories[f]\u0026\u0026a.push(r.categories[f]);for(k in r.services)if(\"string\"\u003d\u003dtypeof k\u0026\u0026\"object\"\u003d\u003dtypeof r.services[k]){var g\u003dr.services[k];for(f\u003d0;f\u003cg.length;f++)\"string\"\u003d\u003dtypeof g[f]\u0026\u0026g[f]\u0026\u0026(c.push(g[f]),\"necessary\"!\u003dk\u0026\u0026\"essential\"!\u003dk||i++)}a.length\u003e0\u0026\u0026(a.sort(),aGTM.d.consent.purposes\u003d\",\"+a.join(\",\")+\",\"),c.length\u003e0\u0026\u0026(c.sort(),aGTM.d.consent.services\u003d\",\"+c.join(\",\")+\",\");var p\u003d\"No Services\";return c.length\u003e0\u0026\u0026c.length\u003d\u003di?p\u003d\"Consent declined\":c.length\u003e0\u0026\u0026c.length\u003ei\u0026\u0026(p\u003d\"Consent accepted\"),aGTM.d.consent.feedback\u003dp,aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Magento CC Cookie"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof localStorage||!localStorage)return!1;if(\"object\"!\u003dtypeof sessionStorage||!sessionStorage)return!1;var n\u003dlocalStorage.getItem(\"consent\");if(\"string\"!\u003dtypeof n||!n)return!1;var t\u003dJSON.parse(n);if(\"object\"!\u003dtypeof t||!t||!t.created||!t.services)return!1;var o\u003dsessionStorage.getItem(\"consent-cache\");if(\"string\"!\u003dtypeof o||!o)return!1;var s\u003dJSON.parse(o);if(\"object\"!\u003dtypeof s||!s||!s.categories)return!1;for(var a\u003d[],r\u003d[],c\u003d[],i\u003d0;i\u003cs.categories.length;i++){var d\u003ds.categories[i];\"object\"\u003d\u003dtypeof d\u0026\u0026d\u0026\u0026d.name\u0026\u0026d.id\u0026\u0026(d.required\u0026\u0026c.push(d.name),(d.checked||d.required)\u0026\u0026(a.push(d.name),r.push(d.id)))}var f\u003d[],p\u003d0,g\u003d[];for(i\u003d0;i\u003ct.services.length;i++){var G\u003dt.services[i];\"object\"\u003d\u003dtypeof G\u0026\u0026G\u0026\u0026G.name\u0026\u0026G.id\u0026\u0026(p++,G.hasConsent\u0026\u0026(f.push(G.name),g.push(G.id)))}a.length\u003e0\u0026\u0026(a.sort(),r.sort(),c.sort()),aGTM.d.consent.purposes\u003d\",\"+a.join(\",\")+\",\",aGTM.d.consent.purposes_ids\u003d\",\"+r.join(\",\")+\",\",aGTM.d.consent.purposes_essential\u003d\",\"+c.join(\",\")+\",\",f.length\u003e0\u0026\u0026(f.sort(),g.sort()),aGTM.d.consent.services\u003d\",\"+f.join(\",\")+\",\",aGTM.d.consent.services_ids\u003d\",\"+g.join(\",\")+\",\",aGTM.d.consent.feedback\u003d\"Consent given by user\",f.length\u003e0\u0026\u0026f.length\u003d\u003dp?aGTM.d.consent.feedback\u003d\"Consent full accepted\":f.length\u003e0\u0026\u0026f.length\u003cp?aGTM.d.consent.feedback\u003d\"Consent partially accepted\":0\u003d\u003df.length\u0026\u0026p\u003e0\u0026\u0026(aGTM.d.consent.feedback\u003d\"Consent declined\"),aGTM.d.consent.hasResponse\u003d!0};",
            "displayValue": "Matomo Consent Check"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(n){if(\"string\"!\u003dtypeof n||\"init\"!\u003dn\u0026\u0026\"update\"!\u003dn)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:n}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003dn\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof Optanon||\"function\"!\u003dtypeof Optanon.GetDomainData)return!1;var t\u003dOptanon.GetDomainData();if(\"object\"!\u003dtypeof t.ConsentIntegrationData||\"object\"!\u003dtypeof t.ConsentIntegrationData.consentPayload||\"object\"!\u003dtypeof t.ConsentIntegrationData.consentPayload.customPayload||\"object\"!\u003dtypeof t.ConsentIntegrationData.consentPayload.purposes||\"object\"!\u003dtypeof t.ConsentModel||\"string\"!\u003dtypeof t.ConsentModel.Name)return!1;var e\u003dt.ConsentIntegrationData.consentPayload;if(\"number\"!\u003dtypeof e.customPayload.Interaction)return!1;if(aGTM.d.consent.interactions\u003de.customPayload.Interaction,\"object\"!\u003dtypeof e.dsDataElements||\"string\"!\u003dtypeof e.dsDataElements.Country)return!1;aGTM.d.consent.consent_model\u003dt.ConsentModel.Name,\"string\"\u003d\u003dtypeof t.cctId\u0026\u0026(aGTM.d.consent.consent_id\u003dt.cctId),\"object\"\u003d\u003dtypeof e.dsDataElements\u0026\u0026\"string\"\u003d\u003dtypeof e.dsDataElements.InteractionType\u0026\u0026(aGTM.d.consent.interaction_type\u003de.dsDataElements.InteractionType),\"object\"\u003d\u003dtypeof e.dsDataElements\u0026\u0026\"string\"\u003d\u003dtypeof e.dsDataElements.Country\u0026\u0026(aGTM.d.consent.country\u003de.dsDataElements.Country);for(var o\u003d{},a\u003d0,s\u003d{},r\u003d0,p\u003d0,c\u003d{},i\u003d0;i\u003ce.purposes.length;i++)c[e.purposes[i].Id]\u003de.purposes[i].TransactionType;for(i\u003d0;i\u003ct.Groups.length;i++)\"string\"\u003d\u003dtypeof c[t.Groups[i].PurposeId]\u0026\u0026(\"NO_CHOICE\"\u003d\u003dc[t.Groups[i].PurposeId]\u0026\u0026(s[t.Groups[i].OptanonGroupId]\u003dt.Groups[i].GroupName.replace(/[^\\w\\d _-]+/g,\"\"),r++),\"NO_CHOICE\"!\u003dc[t.Groups[i].PurposeId]\u0026\u0026\"CONFIRMED\"!\u003dc[t.Groups[i].PurposeId]||(o[t.Groups[i].OptanonGroupId]\u003dt.Groups[i].GroupName.replace(/[^\\w\\d _-]+/g,\"\"),a++),p++);var d\u003d[],f\u003d[];for(k in o)d.push(k),f.push(o[k]);return aGTM.d.consent.purposeIDs\u003d\",\"+d.join(\",\")+\",\",aGTM.d.consent.purposes\u003d\",\"+f.join(\",\")+\",\",aGTM.d.consent.interaction_type?aGTM.d.consent.feedback\u003dtrConfig.cmp.interaction_type:aGTM.d.consent.feedback\u003dp\u003d\u003dr?\"No OptIn Categories available\":a\u003d\u003dp?\"Consent full accepted\":a\u003d\u003dr?\"Consent declined\":a\u003cp?\"Consent partially accepted\":\"Consent given\",aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "OneTrust CookiePro"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;var n\u003daGTM.c.purposes?aGTM.c.purposes.split(\",\"):[];if(\"object\"!\u003dtypeof cc||\"function\"!\u003dtypeof cc.getUserPreferences)return!1;var t\u003dcc.getUserPreferences(),a\u003dt.accept_type,o\u003dt.accepted_categories,c\u003dt.rejected_categories;if(\"string\"!\u003dtypeof a||\"object\"!\u003dtypeof o||\"object\"!\u003dtypeof c)return!1;for(var s\u003do.length,r\u003ds+c.length,f\u003d0;f\u003cs;f++)\"string\"\u003d\u003dtypeof o[f]\u0026\u0026n.push(o[f]);aGTM.d.consent.purposes\u003dn.length\u003e0?\",\"+n.join(\",\")+\",\":\"\";var i\u003d\"Consent available\";return 0\u003d\u003dr?i\u003d\"No purposes available\":s\u003cr?i\u003d\"Consent (partially) declined\":\"all\"\u003d\u003da\u0026\u0026(i\u003d\"Consent full accepted\"),aGTM.d.consent.feedback\u003di,aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Orestbida Cookie Consent"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},aGTM.d.consent.req_ctr\u003daGTM.d.consent.req_ctr||0,aGTM.d.consent.blocked\u003d\"boolean\"\u003d\u003dtypeof aGTM.d.consent.blocked\u0026\u0026aGTM.d.consent.blocked,\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;var n\u003dnew RegExp(\"acris_cookie_acc\u003d([^;]+)\");try{var o\u003ddocument;a\u003dn.exec(o.cookie)}catch(e){}if(void 0\u003d\u003d\u003da)var a\u003d\"\";else a\u003dnull!\u003da?unescape(a[1]):\"\";if(!a)return!1;n\u003dnew RegExp(\"acris_cookie_first_activated\u003d([^;]+)\");try{o\u003ddocument;t\u003dn.exec(o.cookie)}catch(e){}if(void 0\u003d\u003d\u003dt)var t\u003d\"\";else t\u003dnull!\u003dt?decodeURI(t[1]):\"\";if(!t)return!1;var i\u003d[],c\u003dt.split(\"|\").filter(Boolean);if(!c.length)return!1;for(var s\u003d{11:\"Google Analytics\",14:\"Google Adsense\",15:\"Google Ads Conversion Tracking\",18:\"Awin Affiliate Marketing\",49:\"Facebook Pixel\",230:\"Criteo Retargeting\",287:\"Emarsys\",446:\"Bing Ads\"},r\u003d0;r\u003cc.length;r++)i.push(s[c[r]]?s[c[r]]:c[r]);return aGTM.d.consent.services\u003d\",\"+i.join(\",\")+\",\",aGTM.d.consent.serviceIDs\u003d\",\"+c.join(\",\")+\",\",aGTM.d.consent.feedback\u003d\"Consent available\",aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Shopware Acris Cookie"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(n){if(\"string\"!\u003dtypeof n||\"init\"!\u003dn\u0026\u0026\"update\"!\u003dn)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:n}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003dn\u0026\u0026aGTM.d.consent.hasResponse)return!0;var e\u003d\"co\";e+\u003d\"ok\",e+\u003d\"ie\";var t\u003dnew RegExp(\"Consent\u003d([^;]+)\");try{var a\u003ddocument,o\u003dt.exec(a[e])}catch(n){}if(void 0\u003d\u003d\u003do)o\u003d\"\";else\"string\"!\u003dtypeof(o\u003dnull!\u003do?o[1]:\"\")\u0026\u0026(o\u003do.toString());if(!o)return!1;var s\u003d\"string\"\u003d\u003dtypeof o\u0026\u0026o.length\u003e0\u0026\u0026/..+/.test(o);return aGTM.d.consent.purposes\u003ds?\",all,\":\"\",aGTM.d.consent.services\u003ds?\",all,\":\"\",aGTM.d.consent.vendors\u003ds?\",all,\":\"\",aGTM.d.consent.feedback\u003ds?\"Consent accepted\":\"Consent declined\",aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Simple Cookie RegEx Check"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"function\"!\u003dtypeof __tcfapi)return!1;var a\u003d!1,n\u003dnull;__tcfapi(\"getCustomVendorConsents\",2,(function(e,o){a\u003do,n\u003de}));if(\"boolean\"!\u003dtypeof a||!a)return!1;if(\"object\"!\u003dtypeof n||!n)return!1;if(\"boolean\"!\u003dtypeof n.newUser||n.newUser)return!1;if(\"object\"!\u003dtypeof n.grants||!n.grants)return!1;var o\u003daGTM.c.purposes?aGTM.c.purposes.split(\",\"):[],t\u003d[],r\u003d0,s\u003d{\"64480473796ea90689e58702\":\"Store and/or access information on a device\",\"64480473796ea90689e58722\":\"Use limited data to select advertising\",\"64480473796ea90689e58740\":\"Create profiles for personalised advertising\",\"64480473796ea90689e5875e\":\"Use profiles to select personalised advertising\",\"64480473796ea90689e5877c\":\"Create profiles to personalise content\",\"64480473796ea90689e58782\":\"Use profiles to select personalised content\",\"64480473796ea90689e58788\":\"Measure advertising performance\",\"64480473796ea90689e587a7\":\"Measure content performance\",\"64480473796ea90689e587ac\":\"Understand audiences through statistics or combinations of data from different sources\",\"64480473796ea90689e587ca\":\"Develop and improve services\",\"654b93ba18140306b70499b7\":\"Use limited data to select content\",\"64ff0f9f653e3805a8662e8c\":\"Functional\",\"64ff0f9f653e3805a8662e95\":\"Data Share\",\"64ff0f9f653e3805a8662e9b\":\"Social Media\",\"654b9434a5bdb40569d39098\":\"Data use for Identification\",\"64480473796ea90689e58722\":\"Use limited data to select advertising\",\"64480473796ea90689e58788\":\"Measure advertising performance\",\"64480473796ea90689e587a7\":\"Measure content performance\",\"64480473796ea90689e587ac\":\"Understand audiences through statistics or combinations of data from different sources\",\"64480473796ea90689e587ca\":\"Develop and improve services\"},c\u003daGTM.c.vendors?aGTM.c.vendors.split(\",\"):[],i\u003d[],f\u003d0,d\u003d{\"5e7e1298b8e05c4854221be9\":\"Google Inc.\",\"5ee7add94c24944fdb5c5ac6\":\"Hotjar\",\"5e717c8e69966540e4554f05\":\"Instagram\",\"5e839a38b8e05c4e491e738e\":\"Pinterest Inc.\",\"64ad94508c172204ffdb22a4\":\"plista GmbH\",\"5e7ac3fae30e7d1bc1ebf5e8\":\"YouTube\",\"5e542b3a4cd8884eb41b5a72\":\"Google Analytics\",\"63657be8bcb5be04a169758e\":\"Google Maps\",\"5f0f1187b8e05c109c2b8464\":\"JW Player\",\"5e952f6107d9d20c88e7c975\":\"Google Tag Manager\",\"5e7ced57b8e05c5a7d171cda\":\"Adform A/S\",\"62d1372b293cdf1ca87a36f0\":\"CleverPush GmbH\",\"5e98e7f1b8e05c111d01b462\":\"Criteo SA\",\"5ed6aeb2b8e05c2bbe33f4fa\":\"EASYmedia GmbH\",\"5f1aada6b8e05c306c0597d7\":\"Google Advertising Products\",\"5f48d229b8e05c60a307ad97\":\"Kameleoon SAS\",\"5e7ced57b8e05c485246ccde\":\"Outbrain UK Ltd\",\"5ee15bc6b8e05c164c398ae3\":\"RTB House S.A.\",\"5f23e826b8e05c0c0d4fdb8f\":\"Sourcepoint Technologies Inc. (non-CMP)\",\"5e37fc3e56a5e6615502f9c4\":\"Taboola Europe Limited\",\"5efefe25b8e05c109c2b8324\":\"The Reach Group GmbH\",\"5e865b36b8e05c48537f60a7\":\"The UK Trade Desk Ltd\",\"5e716fc09a0b5040d575080f\":\"Facebook Inc.\"};for(k in n.grants){var b\u003dJSON.parse(JSON.stringify(n.grants[k]));f++;var l\u003d!0;if(\"object\"\u003d\u003dtypeof b.purposeGrants)for(p in b.purposeGrants){for(var u\u003d!1,G\u003d0;G\u003ct.length;G++)t[G]\u003d\u003d\u003dp\u0026\u0026(u\u003d!0);u||(r++,\"boolean\"\u003d\u003dtypeof b.purposeGrants[p]\u0026\u0026b.purposeGrants[p]?(t.push(p),o.push(\"string\"\u003d\u003dtypeof s[p]?s[p]:p)):\"boolean\"!\u003dtypeof b.purposeGrants[p]||b.purposeGrants[p]||(l\u003d!1))}\"boolean\"\u003d\u003dtypeof b.vendorGrant\u0026\u0026b.vendorGrant\u0026\u0026l\u0026\u0026(i.push(k),c.push(\"string\"\u003d\u003dtypeof d[k]?d[k]:k))}var M\u003do.map((function(e){return e.replace(\",\",\"\")})),T\u003dc.map((function(e){return e.replace(\",\",\"\")}));return aGTM.d.consent\u003daGTM.d.consent||{},aGTM.d.consent.purposes\u003d\",\"+M.join(\",\")+\",\",aGTM.d.consent.purposeIDs\u003d\",\"+t.join(\",\")+\",\",aGTM.d.consent.vendors\u003d\",\"+T.join(\",\")+\",\",aGTM.d.consent.vendorIDs\u003d\",\"+i.join(\",\")+\",\",aGTM.d.consent.feedback\u003d\"Consent available\",c.length\u003c\u003df\u0026\u0026o.length\u003c\u003dr?aGTM.d.consent.feedback\u003d\"Consent (partially) declined\":c.length\u003d\u003df\u0026\u0026o.length\u003d\u003dr\u0026\u0026(aGTM.d.consent.feedback\u003d\"Consent full accepted\"),aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Sourcepoint"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(n){if(\"string\"!\u003dtypeof n||\"init\"!\u003dn\u0026\u0026\"update\"!\u003dn)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:n}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003dn\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof localStorage||!localStorage)return!1;var e\u003dlocalStorage.getItem(\"consentPermission\");if(\"string\"!\u003dtypeof e||!e)return!1;if(\"true\"!\u003de)return!1;var t\u003d[];\"true\"\u003d\u003de\u0026\u0026t.push(\"Consent\"),aGTM.d.consent.purposes\u003d\",\"+t.join(\",\")+\",\",aGTM.d.consent.feedback\u003d\"Consent accepted\",aGTM.d.consent.hasResponse\u003d!0};",
            "displayValue": "Tramino"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof __ucCmp||\"object\"!\u003dtypeof __ucCmp.cmpController||\"object\"!\u003dtypeof __ucCmp.cmpController.consent||\"object\"!\u003dtypeof __ucCmp.cmpController.dps||\"object\"!\u003dtypeof __ucCmp.cmpController.dps.categories||\"object\"!\u003dtypeof __ucCmp.cmpController.dps.services)return!1;if(\"boolean\"!\u003dtypeof __ucCmp.cmpController.consent.required||__ucCmp.cmpController.consent.required)return!1;var n\u003d__ucCmp.cmpController.dps.categories,o\u003d[],t\u003d0;for(var s in n)if(n.hasOwnProperty(s)\u0026\u0026-1\u003d\u003d\u003do.indexOf(s)){t++;var c\u003dn[s].state;\"ALL_ACCEPTED\"!\u003d\u003dc\u0026\u0026\"SOME_ACCEPTED\"!\u003d\u003dc||o.push(s)}var r\u003d__ucCmp.cmpController.dps.services,i\u003d[],a\u003d[],p\u003d0,l\u003d0;for(var d in r)if(r.hasOwnProperty(d)){p++;var f\u003dr[d];if(f.essential\u0026\u0026-1\u003d\u003d\u003da.indexOf(d)\u0026\u0026l++,f.consent\u0026\u0026f.consent.given\u0026\u0026(-1\u003d\u003d\u003di.indexOf(f.name)\u0026\u0026i.push(f.name),-1\u003d\u003d\u003da.indexOf(d)\u0026\u0026a.push(d)),f.subservices)for(var u in f.subservices)if(f.subservices.hasOwnProperty(u)){p++;var _\u003df.subservices[u];_.essential\u0026\u0026-1\u003d\u003d\u003da.indexOf(u)\u0026\u0026l++,_.consent\u0026\u0026_.consent.given\u0026\u0026(i.push(_.name),a.push(u))}}o.length\u003e0\u0026\u0026(aGTM.d.consent.purposes\u003d\",\"+o.join(\",\")+\",\"),i.length\u003e0\u0026\u0026(aGTM.d.consent.services\u003d\",\"+i.join(\",\")+\",\"),a.length\u003e0\u0026\u0026(aGTM.d.consent.serviceIDs\u003d\",\"+a.join(\",\")+\",\");var C\u003d\"Consent available\";i.length\u003e0\u0026\u0026i.length\u003d\u003dp?C\u003d\"Consent full accepted\":i.length\u003e0\u0026\u0026i.length\u003el?C\u003d\"Consent partially accepted\":i.length\u003e0\u0026\u0026i.length\u003d\u003dl?C\u003d\"Consent declined\":0\u003d\u003di.length\u0026\u0026(C\u003d\"No Consent configured\"),aGTM.d.consent.feedback\u003dC,aGTM.d.consent.consent_id\u003d\"\",\"object\"\u003d\u003dtypeof __ucCmp.cmpController.consent\u0026\u0026\"string\"\u003d\u003dtypeof __ucCmp.cmpController.consent.controllerId\u0026\u0026(aGTM.d.consent.consent_id\u003d__ucCmp.cmpController.consent.controllerId);var T\u003dJSON.parse(JSON.stringify(aGTM.d.consent));return T.purposes\u003do,T.purpose_counter\u003dt,T.services\u003di,T.service_ids\u003da,T.service_counter\u003dp,T.service_essential_counter\u003dl,T.feedback\u003dC,T.consent_id\u003daGTM.d.consent.consent_id,window.usercentrics_aData\u003dT,aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Usercentrics v2"
          },
          {
            "value": "aGTM.f.consent_check\u003dfunction(e){if(\"string\"!\u003dtypeof e||\"init\"!\u003de\u0026\u0026\"update\"!\u003de)return\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"e10\",{action:e}),!1;if(aGTM.d.consent\u003daGTM.d.consent||{},\"init\"\u003d\u003de\u0026\u0026aGTM.d.consent.hasResponse)return!0;if(\"object\"!\u003dtypeof __ucCmp||\"object\"!\u003dtypeof __ucCmp.cmpController||\"object\"!\u003dtypeof __ucCmp.cmpController.consent||\"object\"!\u003dtypeof __ucCmp.cmpController.dps||\"object\"!\u003dtypeof __ucCmp.cmpController.dps.categories||\"object\"!\u003dtypeof __ucCmp.cmpController.dps.services)return!1;if(\"boolean\"!\u003dtypeof __ucCmp.cmpController.consent.required||__ucCmp.cmpController.consent.required)return!1;var n\u003d__ucCmp.cmpController.dps.categories,o\u003d[],t\u003d0;for(var s in n)if(n.hasOwnProperty(s)\u0026\u0026-1\u003d\u003d\u003do.indexOf(s)){t++;var c\u003dn[s].state;\"ALL_ACCEPTED\"!\u003d\u003dc\u0026\u0026\"SOME_ACCEPTED\"!\u003d\u003dc||o.push(s)}var r\u003d__ucCmp.cmpController.dps.services,i\u003d[],p\u003d[],a\u003d0,l\u003d0;for(var f in r)if(r.hasOwnProperty(f)){a++;var u\u003dr[f];if(u.essential\u0026\u0026-1\u003d\u003d\u003dp.indexOf(f)\u0026\u0026l++,u.consent\u0026\u0026u.consent.given\u0026\u0026(-1\u003d\u003d\u003di.indexOf(u.name)\u0026\u0026i.push(u.name),-1\u003d\u003d\u003dp.indexOf(f)\u0026\u0026p.push(f)),u.subservices)for(var d in u.subservices)if(u.subservices.hasOwnProperty(d)){a++;var _\u003du.subservices[d];_.essential\u0026\u0026-1\u003d\u003d\u003dp.indexOf(d)\u0026\u0026l++,_.consent\u0026\u0026_.consent.given\u0026\u0026(i.push(_.name),p.push(d))}}o.length\u003e0\u0026\u0026(aGTM.d.consent.purposes\u003d\",\"+o.join(\",\")+\",\"),i.length\u003e0\u0026\u0026(aGTM.d.consent.services\u003d\",\"+i.join(\",\")+\",\"),p.length\u003e0\u0026\u0026(aGTM.d.consent.serviceIDs\u003d\",\"+p.join(\",\")+\",\");var C\u003d\"Consent available\";i.length\u003e0\u0026\u0026i.length\u003d\u003da?C\u003d\"Consent full accepted\":i.length\u003e0\u0026\u0026i.length\u003el?C\u003d\"Consent partially accepted\":i.length\u003e0\u0026\u0026i.length\u003d\u003dl?C\u003d\"Consent declined\":0\u003d\u003di.length\u0026\u0026(C\u003d\"No Consent configured\"),aGTM.d.consent.feedback\u003dC,aGTM.d.consent.consent_id\u003d\"\",\"object\"\u003d\u003dtypeof __ucCmp.cmpController.consent\u0026\u0026\"string\"\u003d\u003dtypeof __ucCmp.cmpController.consent.controllerId\u0026\u0026(aGTM.d.consent.consent_id\u003d__ucCmp.cmpController.consent.controllerId);var m\u003dJSON.parse(JSON.stringify(aGTM.d.consent));return m.purposes\u003do,m.purpose_counter\u003dt,m.services\u003di,m.service_ids\u003dp,m.service_counter\u003da,m.service_essential_counter\u003dl,m.feedback\u003dC,m.consent_id\u003daGTM.d.consent.consent_id,window.usercentrics_aData\u003dm,aGTM.d.consent.hasResponse\u003d!0,\"function\"\u003d\u003dtypeof aGTM.f.log\u0026\u0026aGTM.f.log(\"m2\",JSON.parse(JSON.stringify(aGTM.d.consent))),!0};",
            "displayValue": "Usercentrics v3 and newer Cookiebot"
          }
        ],
        "simpleValueType": true,
        "notSetText": "Not set"
      },
      {
        "type": "PARAM_TABLE",
        "name": "consent",
        "displayName": "Consent Check Conditions",
        "paramTableColumns": [
          {
            "param": {
              "type": "SELECT",
              "name": "consent_type",
              "displayName": "Type",
              "macrosInSelect": true,
              "selectItems": [
                {
                  "value": "gtmPurposes",
                  "displayValue": "gtmPurposes"
                },
                {
                  "value": "gtmServices",
                  "displayValue": "gtmServices"
                },
                {
                  "value": "gtmVendors",
                  "displayValue": "gtmVendors"
                }
              ],
              "simpleValueType": true
            },
            "isUnique": false
          },
          {
            "param": {
              "type": "TEXT",
              "name": "consent_value",
              "displayName": "Value",
              "simpleValueType": true
            },
            "isUnique": false
          }
        ],
        "newRowButtonText": "Add Consent Check",
        "notSetText": "Add at least one consition, otherwise no consent check will run.",
        "help": "Setup the Consent Conditions. Add at least one consition, otherwise no consent check will run."
      },
      {
        "type": "GROUP",
        "name": "cmp_other",
        "displayName": "Advanced CMP Settings",
        "groupStyle": "ZIPPY_OPEN_ON_PARAM",
        "subParams": [
          {
            "type": "CHECKBOX",
            "name": "sendConsentEvent",
            "checkboxText": "Send a dataLayer Event (\"aGTM_consent\") for Consent Data.",
            "simpleValueType": true,
            "defaultValue": false,
            "help": "If ticked, a separate Consent Event named \"aGTM_consent\" will be fired (after Consent Info is available)"
          },
          {
            "type": "CHECKBOX",
            "name": "useListener",
            "checkboxText": "Use Event Listener (instead of a Timer)",
            "simpleValueType": true,
            "defaultValue": false,
            "help": "Use an event listener to check the consent (true). If it is false, a timer will be used (default) to check the consent. You should add the following command to your Consent Event Listener: aGTM.f.call_cc(); The function returns true, if the consent info has loaded successful, otherwise false. Make sure, that the aGTM lib is loaded before the event listener runs!* If you don\u0027t know what that means, leave this option to false (default). For more information, read the \u003ca href\u003d\"https://github.com/Andiministrator/aGTM#use-event-listeners-instead-of-the-default-timer\"\u003eDocumentation for \"Use Event Listeners instead of the default timer\"\u003c/a\u003e."
          },
          {
            "type": "TEXT",
            "name": "consent_events",
            "displayName": "Name(s) of Consent Event(s) in the dataLayer to update the Consent Data.",
            "simpleValueType": true,
            "canBeEmptyString": true,
            "defaultValue": "",
            "help": "Consent events (comma-separated) for updating the consent.\u003cbr /\u003e For more Information, read the \u003ca href\u003d\"https://github.com/Andiministrator/aGTM#updating-consent-information\"\u003eDocumentation Chapter Updating Consent Information\u003c/a\u003e.",
            "valueHint": "cmpEvent,cmpUpdate"
          }
        ]
      },
      {
        "type": "LABEL",
        "name": "cmp_help",
        "displayName": "Read the \u003ca href\u003d\"https://github.com/Andiministrator/aGTM?tab\u003dreadme-ov-file#consent-handling\"\u003eDocumentation Chapter\u003c/a\u003e for more information."
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "aGTMother",
    "displayName": "Other aGTM Settings",
    "groupStyle": "ZIPPY_OPEN_ON_PARAM",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "aPageview",
        "checkboxText": "Fire GTM dataLayer Event \"aPageview\"",
        "simpleValueType": true,
        "defaultValue": false,
        "help": "If this is ticked. aGTM will automatically fire a dataLayer Event for aPageview."
      },
      {
        "type": "CHECKBOX",
        "name": "vPageview",
        "checkboxText": "Fire GTM dataLayer Event \"vPageview\" (deprecated)",
        "simpleValueType": true,
        "defaultValue": false,
        "help": "If this is ticked. aGTM will automatically fire a dataLayer Event for vPageview."
      },
      {
        "type": "CHECKBOX",
        "name": "vPageviews",
        "checkboxText": "Send Virtual Pageviews",
        "simpleValueType": true,
        "defaultValue": false,
        "help": "Send virtual pageviews (as vPageview) if the URL changes (HistoryChange), but the page doesn\u0027t reload."
      },
      {
        "type": "CHECKBOX",
        "name": "dlStateEvents",
        "checkboxText": "Fire GTM dataLayer Events \"DOMloaded\" and \"PAGEready\"",
        "simpleValueType": true,
        "defaultValue": false,
        "help": "If this is ticked. aGTM will automatically fire dataLayer Events for DOMloaded and PAGEready."
      },
      {
        "type": "TEXT",
        "name": "gdl",
        "displayName": "Name of GTM Datalayer",
        "simpleValueType": true,
        "help": "If you need a diffrenet name (as \"dataLayer\") for the GTM Datalayer, you can specify the Datalayer Name here.",
        "valueHint": "dataLayer"
      },
      {
        "type": "SELECT",
        "name": "dlOrgPush",
        "displayName": "Action for dataLayer.push Hook",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "-",
            "displayValue": "Do Nothing"
          },
          {
            "value": "log",
            "displayValue": "Just send an Exception Event"
          },
          {
            "value": "use",
            "displayValue": "Use the original function"
          },
          {
            "value": "restore",
            "displayValue": "Restore the overwritten function with the original function"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "-",
        "help": "\u003cp\u003eThe dataLayer.push function is the connection from the dataLayer Array to the Google Tag Manager. If this function is changed, the connection can be lost. With this feature you can decide, what to do in this case.\u003c/p\u003e"
      },
      {
        "type": "TEXT",
        "name": "nonce",
        "displayName": "Nonce Value (for Consent Security Policy)",
        "simpleValueType": true,
        "help": "Nonce value for the file injections if CSP (Consent Security Policy) is used.\u003cbr /\u003e If it is set, the nonce will be added to all script-injections.",
        "defaultValue": ""
      },
      {
        "type": "CHECKBOX",
        "name": "debug",
        "checkboxText": "aGTM Debug Mode",
        "simpleValueType": true,
        "defaultValue": false,
        "help": "If this is ticked, the optout cookie will be ignored"
      },
      {
        "type": "LABEL",
        "name": "aGTM Version",
        "displayName": "aGTM v1.4"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_SERVER___

// ssGTM Doku: https://developers.google.com/tag-platform/tag-manager/server-side/api?hl=de
// aGTM Doku: https://github.com/Andiministrator/aGTM
const aGTMversion = "1.4";

// Load Libraries
//const log = require('logToConsole');
const claimRequest = require('claimRequest');
const setResponseStatus = require('setResponseStatus');
const setResponseHeader = require('setResponseHeader');
const setResponseBody = require('setResponseBody');
const returnResponse = require('returnResponse');
const getRequestPath = require('getRequestPath');
const getRequestQueryParameters = require('getRequestQueryParameters');
const fromBase64 = require('fromBase64');
const JSON = require('JSON');

// Check for /aGTM.js Path
if (getRequestPath() !== '/aGTM.js') return;
// Get URL Request Parameters and id
const queryParameters = getRequestQueryParameters();
const id = queryParameters.id || null;
// Return if id is set but not allowed
if (id) {
  let id_allowed = false;
  for (const val of data.ids) {
    if (val.id===id) {
      id_allowed = true;
      break;
    }
  }
  if (!id_allowed) return;
}
// Claim Request
claimRequest();

// Build CMP Code
const cmp = data.cmp ? data.cmp : "";

// Build aGTM Config
const gtm = data.gtm;
const c = {};
// Build gtm object
if (data.gtm) {
  const gtm = {};
  for (const val of data.gtm) {
    if (val.gtm_id) {
      gtm[val.gtm_id] = {};
      if (!val.gtm_consent) gtm[val.gtm_id].noConsent = true;
      if (val.gtm_env) gtm[val.gtm_id].env = val.gtm_env;
      if (val.gtm_url) gtm[val.gtm_id].gtmURL = val.gtm_url;
    }
  }
  c.gtm = gtm;
}
// Add Consent Conditions
if (data.consent) {
  for (const val of data.consent) {
    c[val.consent_type] = val.consent_value;
  }
}
// Add other Consent Options
if (data.sendConsentEvent) c.sendConsentEvent = true;
if (data.useListener) c.useListener = true;
if (data.consent_events) c.consent_events = data.consent_events;
// Other Options
if (data.aPageview) c.aPageview = true;
if (data.vPageview) c.vPageview = true; // deprecated
if (data.vPageviews) c.vPageviews = true;
if (data.dlStateEvents) c.dlStateEvents = true;
if (data.gdl) c.gdl = data.gdl;
if (data.dlOrgPush) c.dlOrgPush = data.dlOrgPush; if (typeof c.dlOrgPush!='string' || c.dlOrgPush=='-') c.dlOrgPush = '';
if (data.nonce) c.nonce = data.nonce;
if (data.debug) c.debug = true;
// Build config string
const config = "aGTM.f.config(" + JSON.stringify(c) + ");";

// aGTM Code
const agtm = fromBase64('d2luZG93LmFHVE09d2luZG93LmFHVE18fHt9LHdpbmRvdy5hR1RNLmM9d2luZG93LmFHVE0uY3x8e30sd2luZG93LmFHVE0uZD13aW5kb3cuYUdUTS5kfHx7fSx3aW5kb3cuYUdUTS5mPXdpbmRvdy5hR1RNLmZ8fHt9LHdpbmRvdy5hR1RNLmw9d2luZG93LmFHVE0ubHx8W10sd2luZG93LmFHVE0ubj13aW5kb3cuYUdUTS5ufHx7fSxhR1RNLmYucHJvcHNldD1mdW5jdGlvbihlLHQsYSl7dHJ5e2VbdF09ZVt0XXx8YX1jYXRjaChlKXt9fSxhR1RNLmYub2JqaW5pdD1mdW5jdGlvbigpe1tbYUdUTS5kLCJ2ZXJzaW9uIiwiMS40Il0sW2FHVE0uZCwiZiIsW11dLFthR1RNLmQsImNvbmZpZyIsITFdLFthR1RNLmQsImluaXQiLCExXSxbYUdUTS5kLCJkb21fcmVhZHkiLCExXSxbYUdUTS5kLCJwYWdlX3JlYWR5IiwhMV0sW2FHVE0uZCwiaXNfaWZyYW1lIix3aW5kb3cuc2VsZiE9PXdpbmRvdy50b3BdLFthR1RNLmQsImV2X2ZjdF9jdHIiLDBdLFthR1RNLmQsInRpbWVyIix7fV0sW2FHVE0uZCwiZXJyb3JfY291bnRlciIsMF0sW2FHVE0uZCwiZXJyb3JzIixbXV0sW2FHVE0uZCwiZGwiLFtdXSxbYUdUTS5kLCJpZnJhbWUiLHtjb3VudGVyOntldmVudHM6MH0sb3JpZ2luOiIiLGlmTGlzdGVuOiExLHRvcExpc3RlbjohMSxoYW5kc2hha2U6ITEsdGltZXI6bnVsbH1dLFthR1RNLmQsImxhc3RfdXJsIixsb2NhdGlvbi5ocmVmXSxbYUdUTS5mLCJ0bCIse31dLFthR1RNLmYsImRsIix7fV0sW2FHVE0uZiwicGwiLHt9XSxbYUdUTSwibCIsW11dLFthR1RNLm4sImNrIiwiY29va2llIl0sW2FHVE0ubiwidG0iLCJnb29nbGV0YWdtYW5hZ2VyIl0sW2FHVE0ubiwidGEiLCJ0YWdhc3Npc3RhbnQuZ29vZ2xlIl1dLmZvckVhY2goKGZ1bmN0aW9uKGUpe2FHVE0uZi5wcm9wc2V0KGVbMF0sZVsxXSxlWzJdKX0pKX0sYUdUTS5mLm9iamluaXQoKSxhR1RNLmYubG9nPWZ1bmN0aW9uKGUsdCl7dmFyIGE9Im9iamVjdCI9PXR5cGVvZiB0JiZ0P0pTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodCkpOnQ7YUdUTS5sLnB1c2goe2lkOmUsdGltZXN0YW1wOihuZXcgRGF0ZSkuZ2V0VGltZSgpLG9iajphfSl9LGFHVE0uZi5zdHJjbGVhbj1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZXx8Im9iamVjdCI9PXR5cGVvZiBlJiYhZT8iIjooInN0cmluZyIhPXR5cGVvZiBlJiYoZT1lLnRvU3RyaW5nKCkpLGUucmVwbGFjZSgvW15hLXrDpMO2w7zDn0EtWsOEw5bDnDAtOV8tXS9nLCIiKSl9LGFHVE0uZi5zU3RyZj1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fCFlKXt2YXIgdD1KU09OLnN0cmluZ2lmeSh7ZXZlbnQ6ImV4Y2VwdGlvbiIsZXJybXNnOiJEYXRhTGF5ZXIgRW50cnkgaXMgbm8gb2JqZWN0IixlcnJ0eXBlOiJETCBFcnJvciIsb2JqX3R5cGU6dHlwZW9mIGUsb2JqX3ZhbHVlOmV9KTtyZXR1cm4gYUdUTS5mLmxvZygiZTE2IixKU09OLnBhcnNlKHQpKSxKU09OLnN0cmluZ2lmeShudWxsKX12YXIgYT1bXTtyZXR1cm4gSlNPTi5zdHJpbmdpZnkoZSwoZnVuY3Rpb24oZSx0KXtpZigib2JqZWN0Ij09dHlwZW9mIHQmJm51bGwhPT10KXtpZigtMSE9PWEuaW5kZXhPZih0KSlyZXR1cm4iW0NpcmN1bGFyXSI7YS5wdXNoKHQpfXJldHVybiB0fSkpfSxhR1RNLmYuYW49ZnVuY3Rpb24oZSx0LGEsbil7ZVt0XT1hLmhhc093blByb3BlcnR5KHQpP2FbdF06bn0sYUdUTS5mLmNvbmZpZz1mdW5jdGlvbihlKXtpZihhR1RNLmQuY29uZmlnKSJmdW5jdGlvbiI9PXR5cGVvZiBhR1RNLmYubG9nJiZhR1RNLmYubG9nKCJlMSIsYUdUTS5jKTtlbHNle2lmKGFHVE0uZi5hbihhR1RNLmMsImRlYnVnIixlLCExKSxhR1RNLmYuYW4oYUdUTS5jLCJwYXRoIixlLCIiKSxhR1RNLmYuYW4oYUdUTS5jLCJmaWxlIixlLCJhR1RNLmpzIiksYUdUTS5mLmFuKGFHVE0uYywiY21wIixlLCIiKSxhR1RNLmMubWluPSJib29sZWFuIiE9dHlwZW9mIGUubWlufHxlLm1pbixhR1RNLmYuYW4oYUdUTS5jLCJub25jZSIsZSwiIiksYUdUTS5mLmFuKGFHVE0uYywiaWZyYW1lU3VwcG9ydCIsZSwhMSksYUdUTS5mLmFuKGFHVE0uYywidlBhZ2V2aWV3cyIsZSwhMSksYUdUTS5mLmFuKGFHVE0uYywidlBhZ2V2aWV3c1RpbWVyIixlLDApLGFHVE0uZi5hbihhR1RNLmMsInZQYWdldmlld3NGYWxsYmFjayIsZSwhMSksYUdUTS5mLmFuKGFHVE0uYywiZ3RtSUQiLGUsIiIpLGUuZ3RtKWZvcih2YXIgdCBpbiBlLmd0bSllLmd0bS5oYXNPd25Qcm9wZXJ0eSh0KSYmKGFHVE0uYy5ndG1JRD1hR1RNLmMuZ3RtSUR8fHQsYUdUTS5jLmd0bT1hR1RNLmMuZ3RtfHx7fSxhR1RNLmMuZ3RtW3RdPWUuZ3RtW3RdfHx7fSxhR1RNLmYuYW4oYUdUTS5jLmd0bVt0XSwibm9Db25zZW50IixlLmd0bVt0XSwhMSksYUdUTS5mLmFuKGFHVE0uYy5ndG1bdF0sImVudiIsZS5ndG1bdF0sIiIpLGFHVE0uZi5hbihhR1RNLmMuZ3RtW3RdLCJpZFBhcmFtIixlLmd0bVt0XSwiIiksYUdUTS5mLmFuKGFHVE0uYy5ndG1bdF0sImd0bVVSTCIsZS5ndG1bdF0sIiIpLGFHVE0uZi5hbihhR1RNLmMuZ3RtW3RdLCJndG1KUyIsZS5ndG1bdF0sIiIpKTthR1RNLmYuYW4oYUdUTS5jLCJnZGwiLGUsImRhdGFMYXllciIpLGFHVE0uZi5hbihhR1RNLmMsImd0bVB1cnBvc2VzIixlLCIiKSxhR1RNLmYuYW4oYUdUTS5jLCJndG1TZXJ2aWNlcyIsZSwiIiksYUdUTS5mLmFuKGFHVE0uYywiZ3RtVmVuZG9ycyIsZSwiIiksYUdUTS5mLmFuKGFHVE0uYywiZ3RtQXR0ciIsZSxudWxsKSxhR1RNLmYuYW4oYUdUTS5jLCJkbFNldCIsZSx7fSksYUdUTS5mLmFuKGFHVE0uYywidXNlTGlzdGVuZXIiLGUsITEpLGFHVE0uZi5hbihhR1RNLmMsImRsT3JnUHVzaCIsZSwiIiksYUdUTS5jLmRsU3RhdGVFdmVudHM9ImJvb2xlYW4iPT10eXBlb2YgZS5kbFN0YXRlRXZlbnRzJiZlLmRsU3RhdGVFdmVudHMsYUdUTS5jLmFQYWdldmlldz0iYm9vbGVhbiI9PXR5cGVvZiBlLmFQYWdldmlldyYmZS5hUGFnZXZpZXcsYUdUTS5jLnZQYWdldmlldz0iYm9vbGVhbiI9PXR5cGVvZiBlLnZQYWdldmlldyYmZS52UGFnZXZpZXcsYUdUTS5jLnNlbmRDb25zZW50RXZlbnQ9ImJvb2xlYW4iPT10eXBlb2YgZS5zZW5kQ29uc2VudEV2ZW50JiZlLnNlbmRDb25zZW50RXZlbnQsZS5jb25zZW50PWUuY29uc2VudHx8e30sYUdUTS5jLmNvbnNlbnQ9YUdUTS5jLmNvbnNlbnR8fGUuY29uc2VudCxhR1RNLmYuYW4oYUdUTS5jLmNvbnNlbnQsImhhc1Jlc3BvbnNlIixlLmNvbnNlbnQsITEpLGFHVE0uZi5hbihhR1RNLmMuY29uc2VudCwiZmVlZGJhY2siLGUuY29uc2VudCwiIiksYUdUTS5mLmFuKGFHVE0uYy5jb25zZW50LCJwdXJwb3NlcyIsZS5jb25zZW50LCIiKSxhR1RNLmYuYW4oYUdUTS5jLmNvbnNlbnQsInNlcnZpY2VzIixlLmNvbnNlbnQsIiIpLGFHVE0uZi5hbihhR1RNLmMuY29uc2VudCwidmVuZG9ycyIsZS5jb25zZW50LCIiKSxhR1RNLmYuYW4oYUdUTS5jLmNvbnNlbnQsImNvbnNlbnRfaWQiLGUuY29uc2VudCwiIiksd2luZG93W2FHVE0uYy5nZGxdPXdpbmRvd1thR1RNLmMuZ2RsXXx8W10sYUdUTS5kLmNvbnNlbnQ9YUdUTS5kLmNvbnNlbnR8fEpTT04ucGFyc2UoYUdUTS5mLnNTdHJmKGFHVE0uYy5jb25zZW50KSksYUdUTS5kLmNvbnNlbnQuZ3RtQ29uc2VudD0hMSxhR1RNLmQuY29uZmlnPSEwLGFHVE0uZC5ndG1Mb2FkZWQ9W10sImZ1bmN0aW9uIj09dHlwZW9mIGFHVE0uZi5sb2cmJmFHVE0uZi5sb2coIm0xIixhR1RNLmMpfX0sYUdUTS5mLmxvYWRfY2M9ZnVuY3Rpb24oZSx0KXt2YXIgYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKSxuPWFHVE0uYy5wYXRofHwiIjtuLmxlbmd0aD4wJiYiLyIhPT1uLmNoYXJBdChuLmxlbmd0aC0xKSYmKG4rPSIvIik7dmFyIG89ImNtcC9jY18iK2FHVE0uZi5zdHJjbGVhbihlKSsoYUdUTS5jLm1pbj8iLm1pbiI6IiIpKyIuanMiO2Euc3JjPW4rbyxhR1RNLmMubm9uY2UmJihhLm5vbmNlPWFHVE0uYy5ub25jZSksYS5vbnJlYWR5c3RhdGVjaGFuZ2U9YS5vbmxvYWQ9ZnVuY3Rpb24oKXthLnJlYWR5U3RhdGUmJiEvbG9hZGVkfGNvbXBsZXRlLy50ZXN0KGEucmVhZHlTdGF0ZSl8fCJmdW5jdGlvbiI9PXR5cGVvZiB0JiZ0KCl9LGEuYXN5bmM9ITAsZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChhKX0sYUdUTS5mLmNoZWxwPWZ1bmN0aW9uKGUsdCl7dmFyIGE9ITA7cmV0dXJuIGUmJnQmJmUuc3BsaXQoIiwiKS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LmluZGV4T2YoIiwiK2UudHJpbSgpKyIsIik8MCYmKGE9ITEpfSkpLGF9LGFHVE0uZi5ldmFsQ29ucz1mdW5jdGlvbihlLHQpe3ZhciBpc0NvbnNlbnRHaXZlbj1mdW5jdGlvbihlLHQpe3JldHVybiBlLmV2ZXJ5KChmdW5jdGlvbihlKXtyZXR1cm4gdC5pbmRleE9mKCIsIitlKyIsIik+PTB9KSl9LGE9IWUucHVycG9zZXMubGVuZ3RofHxpc0NvbnNlbnRHaXZlbihlLnB1cnBvc2VzLHQucHVycG9zZXMpLG49IWUuc2VydmljZXMubGVuZ3RofHxpc0NvbnNlbnRHaXZlbihlLnNlcnZpY2VzLHQuc2VydmljZXMpLG89IWUudmVuZG9ycy5sZW5ndGh8fGlzQ29uc2VudEdpdmVuKGUudmVuZG9ycyx0LnZlbmRvcnMpO3JldHVybiBhJiZuJiZvfSxhR1RNLmYucnVuX2NjPWZ1bmN0aW9uKGUpe3JldHVybiBhR1RNLmQuY29uZmlnPyJzdHJpbmciIT10eXBlb2YgZXx8ImluaXQiIT09ZSYmInVwZGF0ZSIhPT1lPyhhR1RNLmYubG9nKCJlNSIse2FjdGlvbjplfSksITEpOiJmdW5jdGlvbiIhPXR5cGVvZiBhR1RNLmYuY29uc2VudF9jaGVjaz8oYUdUTS5mLmxvZygiZTE0Iix7YWN0aW9uOmV9KSwhMSk6YUdUTS5mLmNvbnNlbnRfY2hlY2soZSk/KHdpbmRvd1thR1RNLmMuZ2RsXT13aW5kb3dbYUdUTS5jLmdkbF18fFtdLGFHVE0uZi5jaGVscChhR1RNLmMuZ3RtUHVycG9zZXMsYUdUTS5kLmNvbnNlbnQucHVycG9zZXMpJiZhR1RNLmYuY2hlbHAoYUdUTS5jLmd0bVNlcnZpY2VzLGFHVE0uZC5jb25zZW50LnNlcnZpY2VzKSYmYUdUTS5mLmNoZWxwKGFHVE0uYy5ndG1WZW5kb3JzLGFHVE0uZC5jb25zZW50LnZlbmRvcnMpP2FHVE0uZC5jb25zZW50Lmd0bUNvbnNlbnQ9ITA6YUdUTS5kLmNvbnNlbnQuZ3RtQ29uc2VudD0iYm9vbGVhbiI9PXR5cGVvZiBhR1RNLmQuY29uc2VudC5ibG9ja2VkJiZhR1RNLmQuY29uc2VudC5ibG9ja2VkLCJ1cGRhdGUiPT1lJiYoYUdUTS5kLmluaXR8fGFHVE0uZi5pbmplY3QoKSxhR1RNLmYuc2VuZG5hdXMoe2V2ZW50OiJhR1RNX2NvbnNlbnRfdXBkYXRlIixhR1RNdHM6KG5ldyBEYXRlKS5nZXRUaW1lKCksYUdUTWNvbnNlbnQ6YUdUTS5kLmNvbnNlbnQ/SlNPTi5wYXJzZShhR1RNLmYuc1N0cmYoYUdUTS5kLmNvbnNlbnQpKTp7fX0pKSwiZnVuY3Rpb24iPT10eXBlb2YgYUdUTS5mLmNvbnNlbnRfY2FsbGJhY2smJmFHVE0uZi5jb25zZW50X2NhbGxiYWNrKGUpLGFHVE0uZi5sb2coIm0zIixhR1RNLmQuY29uc2VudCksITApOihhR1RNLmYubG9nKCJtOCIsbnVsbCksITEpOihhR1RNLmYubG9nKCJlNCIsbnVsbCksITEpfSxhR1RNLmYuY2FsbF9jYz1mdW5jdGlvbigpe3JldHVybiEoImZ1bmN0aW9uIiE9dHlwZW9mIGFHVE0uZi5ydW5fY2N8fCFhR1RNLmYucnVuX2NjKCJpbml0IikpJiYodm9pZCAwIT09YUdUTS5kLnRpbWVyLmNvbnNlbnQmJihjbGVhckludGVydmFsKGFHVE0uZC50aW1lci5jb25zZW50KSxkZWxldGUgYUdUTS5kLnRpbWVyLmNvbnNlbnQpLCEhYUdUTS5kLmluaXR8fGFHVE0uZi5pbmplY3QoKSl9LCJmdW5jdGlvbiIhPXR5cGVvZiBhR1RNLmYuY29uc2VudF9saXN0ZW5lciYmKGFHVE0uZi5jb25zZW50X2xpc3RlbmVyPWZ1bmN0aW9uKCl7YUdUTS5jLnVzZUxpc3RlbmVyfHwoYUdUTS5kLnRpbWVyLmNvbnNlbnQ9c2V0SW50ZXJ2YWwoYUdUTS5mLmNhbGxfY2MsMWUzKSl9KSxhR1RNLmYuZ2M9ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFJlZ0V4cChlKyI9KFteO10rKSIpLGE9bnVsbDt0cnl7dmFyIG49ZG9jdW1lbnQsbz10LmV4ZWMoblthR1RNLm4uY2tdKTtvJiZvLmxlbmd0aD4xJiYoYT1kZWNvZGVVUklDb21wb25lbnQob1sxXSkpfWNhdGNoKGUpe31yZXR1cm4gYX0sYUdUTS5mLnNjPWZ1bmN0aW9uKGUsdCl7aWYoInN0cmluZyI9PXR5cGVvZiBlJiZlJiZ0KXRyeXtkb2N1bWVudFthR1RNLm4uY2tdPWUrIj0iK3QrIjsgU2VjdXJlOyBTYW1lU2l0ZT1MYXg7IHBhdGg9LyJ9Y2F0Y2goZSl7fX0sYUdUTS5mLnVybFBhcmFtPWZ1bmN0aW9uKGUsdCl7dmFyIGE9bmV3IFJlZ0V4cCgiWz8mXSIrZSsiKD0oW14mI10qKXwmfCN8JCkiKS5leGVjKHQpO3JldHVybiBhJiZhWzJdP2RlY29kZVVSSUNvbXBvbmVudChhWzJdLnJlcGxhY2UoL1wrL2csIiAiKSk6bnVsbH0sYUdUTS5mLm9wdG91dD1mdW5jdGlvbigpe3ZhciBlPSExLHQ9YUdUTS5mLnVybFBhcmFtKCJhR1RNb3B0b3V0Iix3aW5kb3cubG9jYXRpb24uaHJlZik7aWYodCYmIjAiIT09dClhR1RNLmYuc2MoImFHVE1vcHRvdXQiLCIxIiksZT0hMDtlbHNlIGlmKCIwIj09PXQpYUdUTS5mLnNjKCJhR1RNb3B0b3V0IiwiMCIpO2Vsc2V7dmFyIGE9YUdUTS5mLmdjKCJhR1RNb3B0b3V0Iik7YSYmIjAiIT09YSYmKGU9ITApfWlmKGUpe2Zvcih2YXIgbiBpbiBhR1RNKWFHVE0uaGFzT3duUHJvcGVydHkobikmJiJmIiE9PW4mJmRlbGV0ZSBhR1RNW25dO3JldHVybiBhR1RNLmYub2JqaW5pdCgpLCJmdW5jdGlvbiI9PXR5cGVvZiBhR1RNLmYub3B0b3V0X2NhbGxiYWNrJiZhR1RNLmYub3B0b3V0X2NhbGxiYWNrKCksITB9cmV0dXJuITF9LGFHVE0uZi5hR1RNX2V2ZW50PWZ1bmN0aW9uKGUpeyJvYmplY3QiIT10eXBlb2YgYUdUTS5kLmNvbnNlbnQmJihhR1RNLmQuY29uc2VudD1udWxsKSxlfHwoZT0iYUdUTV9ldmVudCIpO3ZhciB0PXtldmVudDplLGFHVE10czoobmV3IERhdGUpLmdldFRpbWUoKSxhR1RNY29uc2VudDphR1RNLmQuY29uc2VudD9KU09OLnBhcnNlKGFHVE0uZi5zU3RyZihhR1RNLmQuY29uc2VudCkpOnt9fTtyZXR1cm4iYUdUTV9yZWFkeSI9PWUmJih0LmFHVE09e3ZlcnNpb246YUdUTS5kLnZlcnNpb24saXNfaWZyYW1lOmFHVE0uZC5pc19pZnJhbWUsaGFzdHlFdmVudHM6YUdUTS5kLmYsZXJyb3JzOmFHVE0uZC5lcnJvcnN9KSx0fSxhR1RNLmYucHJveHlTdXBwb3J0PWZ1bmN0aW9uKCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIFByb3h5KXJldHVybiExO3RyeXtyZXR1cm4gbmV3IFByb3h5KChmdW5jdGlvbigpe30pLHthcHBseTpmdW5jdGlvbigpe3JldHVybiEwfX0pKCl9Y2F0Y2goZSl7cmV0dXJuITF9fSxhR1RNLmYudXJsTGlzdGVuZXI9ZnVuY3Rpb24oZSx0LGEpe2NvbnNvbGUubG9nKCJVUkwgTGlzdGVuZXIgc3RhcnRlZCIse2V2ZW50bmFtZTplLGludGVydmFsOnQsZmFsbGJhY2s6YX0pLCJudW1iZXIiIT10eXBlb2YgdCYmKHQ9NTAwKSwiYm9vbGVhbiIhPXR5cGVvZiBhJiYoYT0hMSksYUdUTS5kLmxhc3RfdXJsPWFHVE0uZC5sYXN0X3VybHx8YUdUTS5mLmdldFZhbCgibCIsImhyZWYiKSwic3RyaW5nIj09dHlwZW9mIGFHVE0uZC5sYXN0X3VybCYmYUdUTS5kLmxhc3RfdXJsfHwoYUdUTS5kLmxhc3RfdXJsPSIiKTt2YXIgY2hlY2tVcmxDaGFuZ2U9ZnVuY3Rpb24oKXt2YXIgdD1hR1RNLmYuZ2V0VmFsKCJsIiwiaHJlZiIpfHwiIjtpZih0IT1hR1RNLmQubGFzdF91cmwpeyJzdHJpbmciIT10eXBlb2YgZSYmKGU9InZQYWdldmlldyIpO3ZhciBhPXtldmVudDplfTthLm9sZFVSTD1hR1RNLmQubGFzdF91cmwsYS5uZXdVUkw9dCxhLm5ld1RpdGxlPWRvY3VtZW50LnRpdGxlLGFHVE0uZi5maXJlKGEpLGFHVE0uZC5sYXN0X3VybD10fX07YUdUTS5mLmV2THN0bigid2luZG93IiwicG9wc3RhdGUiLGNoZWNrVXJsQ2hhbmdlKSxhR1RNLmYuZXZMc3RuKCJ3aW5kb3ciLCJoYXNoY2hhbmdlIixjaGVja1VybENoYW5nZSk7dmFyIG49ITE7aWYoYUdUTS5mLnByb3h5U3VwcG9ydCl7dmFyIG89e2FwcGx5OmZ1bmN0aW9uKGUsdCxhKXt2YXIgbj1lLmFwcGx5KHQsYSk7cmV0dXJuIGNoZWNrVXJsQ2hhbmdlKCksbn19O2hpc3RvcnkucHVzaFN0YXRlPW5ldyBQcm94eShoaXN0b3J5LnB1c2hTdGF0ZSxvKSxoaXN0b3J5LnJlcGxhY2VTdGF0ZT1uZXcgUHJveHkoaGlzdG9yeS5yZXBsYWNlU3RhdGUsbyksbj0hMH0odD4wJiYhbiYmYXx8dD4wJiYhYSkmJmFHVE0uZi50aW1lcigidXJsTGlzdGVuZXIiLGNoZWNrVXJsQ2hhbmdlLG51bGwsdCwwKX0sYUdUTS5mLmd0bV9sb2FkPWZ1bmN0aW9uKGUsdCxhLG4sbyxyKXtpZihhR1RNLmQuY29uZmlnKXtpZigib2JqZWN0IiE9dHlwZW9mIGFHVE0uZC5ndG1Mb2FkZWQmJihhR1RNLmQuZ3RtTG9hZGVkPVtdKSxhR1RNLmQuZ3RtTG9hZGVkLmxlbmd0aDwxJiYoYUdUTS5mLnNlbmRuYXVzKGFHVE0uZi5hR1RNX2V2ZW50KCJhR1RNX3JlYWR5IikpLGEmJmFHVE0uZi5zZW5kbmF1cyh7ZXZlbnQ6Imd0bS5qcyIsImd0bS5zdGFydCI6KG5ldyBEYXRlKS5nZXRUaW1lKCl9KSxhR1RNLmMuYVBhZ2V2aWV3JiZhR1RNLmYuc2VuZG5hdXMoe2V2ZW50OiJhUGFnZXZpZXciLGFHVE10czoobmV3IERhdGUpLmdldFRpbWUoKX0pLGFHVE0uYy52UGFnZXZpZXcmJmFHVE0uZi5zZW5kbmF1cyh7ZXZlbnQ6InZQYWdldmlldyIsYUdUTXRzOihuZXcgRGF0ZSkuZ2V0VGltZSgpfSksYUdUTS5jLnZQYWdldmlld3MmJmFHVE0uZi51cmxMaXN0ZW5lcigidlBhZ2V2aWV3IixhR1RNLmMudlBhZ2V2aWV3c1RpbWVyLGFHVE0uYy52UGFnZXZpZXdzRmFsbGJhY2spKSxhR1RNLmQuY29uc2VudEV2ZW50X2ZpcmVkPSJib29sZWFuIj09dHlwZW9mIGFHVE0uZC5jb25zZW50RXZlbnRfZmlyZWQmJmFHVE0uZC5jb25zZW50RXZlbnRfZmlyZWQsYUdUTS5jLnNlbmRDb25zZW50RXZlbnQmJiFhR1RNLmQuY29uc2VudEV2ZW50X2ZpcmVkJiYib2JqZWN0Ij09dHlwZW9mIGFHVE0uZC5jb25zZW50JiZhR1RNLmQuY29uc2VudC5oYXNSZXNwb25zZSYmKGFHVE0uZi5zZW5kbmF1cyhhR1RNLmYuYUdUTV9ldmVudCgiYUdUTV9jb25zZW50IikpLGFHVE0uZC5jb25zZW50RXZlbnRfZmlyZWQ9ITApLGEpe258fChuPSJpZCIpO3ZhciBpPSExLGM9YUdUTS5mLmdjKCJhR1RNZGVidWciKTtpZihjJiZwYXJzZUludChjKT4wJiYoaT0hMCksIWkpe3ZhciBmPW5ldyBVUkwoZG9jdW1lbnQubG9jYXRpb24uaHJlZik7YUdUTS5mLnVybFBhcmFtKCJndG1fZGVidWciLGYpJiYoaT0hMCl9aWYoIWkmJmRvY3VtZW50LnJlZmVycmVyKShmPW5ldyBVUkwoZG9jdW1lbnQucmVmZXJyZXIpKS5ob3N0bmFtZT09YUdUTS5uLnRhKyIuY29tIiYmKGk9ITApOyFjJiZpJiZhR1RNLmYuc2MoImFHVE1kZWJ1ZyIsIjEiKTt2YXIgcz10LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO2lmKHMuaWQ9ImFHVE1fdG1fIithLHMuYXN5bmM9ITAsIm9iamVjdCI9PXR5cGVvZiBhR1RNLmMuZ3RtQXR0cilmb3IodmFyIFQgaW4gYUdUTS5jLmd0bUF0dHIpcy5zZXRBdHRyaWJ1dGUoVCxhR1RNLmMuZ3RtQXR0cltUXSk7aWYoYUdUTS5jLm5vbmNlJiYocy5ub25jZT1hR1RNLmMubm9uY2UpLHIuZ3RtSlMmJiFpKXMuaW5uZXJIVE1MPWF0b2Ioci5ndG1KUyk7ZWxzZXt2YXIgTT1yLmd0bVVSTHx8Imh0dHBzOi8vd3d3LiIrYUdUTS5uLnRtKyIuY29tL2d0bS5qcyIsRz1yLmVudnx8IiIsZD0tMT09PU0uaW5kZXhPZigiPyIpPyI/IjoiJiI7cy5zcmM9TStkK24rIj0iK2ErIiZsPSIrbytHfXZhciBsPXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNjcmlwdCIpWzBdO2wucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocyxsKSxhR1RNLmQuZ3RtTG9hZGVkLnB1c2goYXx8Im5vX2d0bV9pZCIpfX1lbHNlIGFHVE0uZi5sb2coImU3IixudWxsKX0sYUdUTS5mLmRvbXJlYWR5PWZ1bmN0aW9uKGUpe3ZhciB0PSExO2FHVE0uZi52T2IoZSl8fChlPXthTVNHOiJFbXB0eSBET01yZWFkeSBldmVudCBmaXJlZC4ifSx0PSEwKSxlLmV2ZW50fHwoZS5ldmVudD0iYURPTXJlYWR5IiksYUdUTS5kLmRvbV9yZWFkeSYmdHx8KCFhR1RNLmMuZGxTdGF0ZUV2ZW50cyYmdHx8YUdUTS5mLmZpcmUoZSksdCYmKGFHVE0uZC5kb21fcmVhZHk9ITApKX0sYUdUTS5mLnBhZ2VyZWFkeT1mdW5jdGlvbihlKXt2YXIgdD0hMTthR1RNLmYudk9iKGUpfHwoZT17YU1TRzoiRW1wdHkgUEFHRXJlYWR5IGV2ZW50IGZpcmVkLiJ9LHQ9ITApLGUuZXZlbnR8fChlLmV2ZW50PSJhUEFHRXJlYWR5IiksYUdUTS5kLnBhZ2VfcmVhZHkmJnR8fCghYUdUTS5jLmRsU3RhdGVFdmVudHMmJnR8fGFHVE0uZi5maXJlKGUpLHQmJihhR1RNLmQucGFnZV9yZWFkeT0hMCkpfSxhR1RNLmYuaW5pdEdUTT1mdW5jdGlvbihlKXtpZigib2JqZWN0Ij09dHlwZW9mIGFHVE0uYy5ndG0mJmFHVE0uYy5ndG0pe3ZhciB0PTA7Zm9yKHZhciBhIGluIGFHVE0uYy5ndG0pdCsrLGFHVE0uYy5ndG0uaGFzT3duUHJvcGVydHkoYSkmJigiYm9vbGVhbiIhPXR5cGVvZiBhR1RNLmMuZ3RtW2FdLmhhc0xvYWRlZCYmKGFHVE0uYy5ndG1bYV0uaGFzTG9hZGVkPSExKSxhR1RNLmMuZ3RtW2FdLmhhc0xvYWRlZHx8ZSYmIWFHVE0uYy5ndG1bYV0ubm9Db25zZW50fHwoYUdUTS5mLmd0bV9sb2FkKHdpbmRvdyxkb2N1bWVudCxhLGFHVE0uYy5ndG1bYV0uaWRQYXJhbT9hR1RNLmMuZ3RtW2FdLmlkUGFyYW06IiIsYUdUTS5jLmdkbCxhR1RNLmMuZ3RtW2FdKSxhR1RNLmMuZ3RtW2FdLmhhc0xvYWRlZD0hMCkpO3R8fGFHVE0uZi5ndG1fbG9hZCh3aW5kb3csZG9jdW1lbnQsIiIsYUdUTS5jLmd0bVthXS5pZFBhcmFtP2FHVE0uYy5ndG1bYV0uaWRQYXJhbToiIixhR1RNLmMuZ2RsLG51bGwpfX0sYUdUTS5mLmNoa0RQcmVhZHk9ZnVuY3Rpb24oKXt2YXIgZT1kb2N1bWVudC5yZWFkeVN0YXRlOyJpbnRlcmFjdGl2ZSI9PT1lfHwiY29tcGxldGUiPT09ZT9hR1RNLmYuZG9tcmVhZHkobnVsbCk6YUdUTS5mLmV2THN0bihkb2N1bWVudCwiRE9NQ29udGVudExvYWRlZCIsYUdUTS5mLmRvbXJlYWR5KSwiY29tcGxldGUiPT09ZT9hR1RNLmYucGFnZXJlYWR5KG51bGwpOmFHVE0uZi5ldkxzdG4od2luZG93LCJsb2FkIixhR1RNLmYucGFnZXJlYWR5KX0sYUdUTS5mLmluamVjdD1mdW5jdGlvbigpe2lmKCFhR1RNLmQuY29uZmlnKXJldHVybiBhR1RNLmYubG9nKCJlOCIsbnVsbCksITE7aWYoIm9iamVjdCIhPXR5cGVvZiBhR1RNLmQuY29uc2VudHx8ImJvb2xlYW4iIT10eXBlb2YgYUdUTS5kLmNvbnNlbnQuaGFzUmVzcG9uc2V8fCFhR1RNLmQuY29uc2VudC5oYXNSZXNwb25zZSlyZXR1cm4gYUdUTS5mLmxvZygiZTEzIixudWxsKSwhMTthR1RNLmQuaW5pdHx8KCh3aW5kb3dbYUdUTS5jLmdkbF18fFtdKS5mb3JFYWNoKChmdW5jdGlvbihlLHQpe2lmKCJvYmplY3QiPT10eXBlb2YgZSYmZSl7aWYoIWUuYUdUTWNoayl7ZS5hR1RNZGw9ITA7dmFyIGE9SlNPTi5wYXJzZShhR1RNLmYuc1N0cmYoZSkpO3ZvaWQgMCE9PWFbImd0bS51bmlxdWVFdmVudElkIl0mJmRlbGV0ZSBhWyJndG0udW5pcXVlRXZlbnRJZCJdLGFHVE0uZC5mLnB1c2goYSl9fWVsc2UgYUdUTS5mLmxvZygiZTE3Iix7b2JqX3R5cGU6dHlwZW9mIGUsb2JqX3ZhbHVlOmUsaW5kZXg6dH0pLGFHVE0uZC5mLnB1c2goe2V2ZW50OiJleGNlcHRpb24iLGVycm1zZzoiRGF0YUxheWVyIEVudHJ5IGlzIG5vIG9iamVjdCIsZXJydHlwZToiREwgRXJyb3IiLG9ial90eXBlOnR5cGVvZiBlLG9ial92YWx1ZTplfSl9KSksYUdUTS5kLmNvbnNlbnQuZ3RtQ29uc2VudCYmKGFHVE0uZi5pbml0R1RNKCExKSxhR1RNLmQuaW5pdD0hMCksYUdUTS5kLmluaXQmJmFHVE0uZi5jaGtEUHJlYWR5KCkpO3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBhR1RNLmYuaW5qZWN0X2NhbGxiYWNrJiZhR1RNLmYuaW5qZWN0X2NhbGxiYWNrKCksYUdUTS5mLmxvZygibTYiLG51bGwpLCEwfSxhR1RNLmYuaUZyYW1lRmlyZT1mdW5jdGlvbihlKXsib2JqZWN0Ij09dHlwZW9mIGUmJmUmJihhR1RNLmQuaXNfaWZyYW1lJiYic3RyaW5nIj09dHlwZW9mIGUuZXZlbnQmJi9eKGFHVE18Z3RtXC58W2F2XURPTXJlYWR5fFthdl1QQUdFcmVhZHkpLy50ZXN0KGUuZXZlbnQpP2FHVE0uZi5zZW5kbmF1cyhlKTooZS5hR1RNX3NvdXJjZT0iaUZyYW1lICIrZG9jdW1lbnQubG9jYXRpb24uaG9zdG5hbWUsYUdUTS5kLmlmcmFtZS5jb3VudGVyLmV2ZW50cysrLGUuaWZFdkN0cj1hR1RNLmQuaWZyYW1lLmNvdW50ZXIuZXZlbnRzLCJzdHJpbmciPT10eXBlb2YgZS5ldmVudCYmZS5ldmVudCYmKGFHVE0uZC5pZnJhbWUuY291bnRlcltlLmV2ZW50XT1hR1RNLmQuaWZyYW1lLmNvdW50ZXJbZS5ldmVudF18fDAsYUdUTS5kLmlmcmFtZS5jb3VudGVyW2UuZXZlbnRdKyssZVsiaWZFdkN0cl8iK2UuZXZlbnRdPWFHVE0uZC5pZnJhbWUuY291bnRlcltlLmV2ZW50XSksZS5hR1RNdHMmJmRlbGV0ZSBlLmFHVE10cyxlLmFHVE1wYXJhbXMmJmRlbGV0ZSBlLmFHVE1wYXJhbXMsYUdUTS5kLmlmcmFtZS5vcmlnaW4/d2luZG93LnRvcC5wb3N0TWVzc2FnZShlLGFHVE0uZC5pZnJhbWUub3JpZ2luKTphR1RNLmQuZi5xdWV1ZS5wdXNoKGUpKSl9LGFHVE0uZi5pZkhhbmRzaGFrZT1mdW5jdGlvbigpe2lmKCFhR1RNLmQuaXNfaWZyYW1lJiYhYUdUTS5kLmlmcmFtZS5oYW5kc2hha2Upe3ZhciBlPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpZnJhbWUiKTtpZighZS5sZW5ndGgpcmV0dXJuO2Zvcih2YXIgdD0wO3Q8ZS5sZW5ndGg7dCsrKXt2YXIgYT1lW3RdO2EmJmEuY29udGVudFdpbmRvdyYmYS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlJiZhLmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoImFHVE1fVG9wMmlGcmFtZSBIYW5kc2hha2UiLCIqIil9YUdUTS5kLmlmcmFtZS5oYW5kc2hha2U9ITB9fSxhR1RNLmYuaWZIU2xpc3Rlbj1mdW5jdGlvbihlKXtpZihhR1RNLmQuaXNfaWZyYW1lJiYic3RyaW5nIj09dHlwZW9mIGUuZGF0YSYmImFHVE1fVG9wMmlGcmFtZSBIYW5kc2hha2UiPT1lLmRhdGEpZm9yKGFHVE0uZC5pZnJhbWUub3JpZ2luPWUub3JpZ2luLGFHVE0uZC5pZnJhbWUuaWZMaXN0ZW49ITEsd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGFHVE0uZi5pZkhTbGlzdGVuLCExKTthR1RNLmQuZi5sZW5ndGg7KXt2YXIgdD1hR1RNLmQuZi5zaGlmdCgpO2FHVE0uZi5pRnJhbWVGaXJlKHQpfX0sYUdUTS5mLnZPYj1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fCFlKXJldHVybiExO3RyeXtKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGUpKX1jYXRjaChlKXtyZXR1cm4hMX1yZXR1cm4hMH0sYUdUTS5mLnZTdD1mdW5jdGlvbihlKXt2YXIgdD1BcnJheS5pc0FycmF5KGUpP2U6InN0cmluZyI9PXR5cGVvZiBlP1tlXTpbXTtyZXR1cm4gMCE9PXQubGVuZ3RoJiZ0LmV2ZXJ5KChmdW5jdGlvbihlKXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIGUmJiIiIT09ZX0pKX0sYUdUTS5mLmV2THN0bj1mdW5jdGlvbihlLHQsYSl7aWYoIndpbmRvdyI9PT1lJiYoZT13aW5kb3cpLCJkb2N1bWVudCI9PT1lJiYoZT1kb2N1bWVudCksIm9iamVjdCI9PXR5cGVvZiBlJiZlJiYic3RyaW5nIj09dHlwZW9mIHQmJiJmdW5jdGlvbiI9PXR5cGVvZiBhKXRyeXsibWVzc2FnZSI9PXQ/YUdUTS5kLmlmcmFtZS50b3BMaXN0ZW58fGFHVE0uZC5pc19pZnJhbWV8fChhR1RNLmQuaWZyYW1lLnRvcExpc3Rlbj0hMCxlLmFkZEV2ZW50TGlzdGVuZXIodCwoZnVuY3Rpb24oZSl7YSh2b2lkIDAhPT1lLmRhdGE/ZS5kYXRhOm51bGwsInN0cmluZyI9PXR5cGVvZiBlLm9yaWdpbj9lLm9yaWdpbjoiIil9KSkpOmUuYWRkRXZlbnRMaXN0ZW5lcih0LGEpfWNhdGNoKG4pe2FHVE0uZi5sb2coImUxMiIse2Vycm9yOm4sZWw6ZSxldjp0LGZjdDphfSl9ZWxzZSBhR1RNLmYubG9nKCJlMTEiLHtlbDplLGV2OnQsZmN0OmF9KX0sYUdUTS5mLnJtTHN0bj1mdW5jdGlvbihlLHQsYSl7IndpbmRvdyI9PT1lJiYoZT13aW5kb3cpLCJkb2N1bWVudCI9PT1lJiYoZT1kb2N1bWVudCk7dHJ5e2UucmVtb3ZlRXZlbnRMaXN0ZW5lcih0LGEpfWNhdGNoKGUpe319LGFHVE0uZi5nZXRWYWw9ZnVuY3Rpb24oZSx0KXtpZihhR1RNLmYudlN0KFtlLHRdKSYmdC5tYXRjaCgvW2Etel0rL2kpJiYoInAiIT1lfHwib2JqZWN0Ij09dHlwZW9mIHBlcmZvcm1hbmNlJiZwZXJmb3JtYW5jZSkpc3dpdGNoKGUpe2Nhc2UidyI6cmV0dXJuIGFHVE0uZi52T2Iod2luZG93W3RdKT9KU09OLnBhcnNlKGFHVE0uZi5zU3RyZih3aW5kb3dbdF0pKTp3aW5kb3dbdF07Y2FzZSJuIjpyZXR1cm4gYUdUTS5mLnZPYihuYXZpZ2F0b3JbdF0pP0pTT04ucGFyc2UoYUdUTS5mLnNTdHJmKG5hdmlnYXRvclt0XSkpOm5hdmlnYXRvclt0XTtjYXNlImQiOnJldHVybiBkb2N1bWVudFt0XTtjYXNlImwiOnJldHVybiBkb2N1bWVudC5sb2NhdGlvblt0XTtjYXNlImgiOnJldHVybiBkb2N1bWVudC5oZWFkW3RdO2Nhc2UiYiI6cmV0dXJuIGRvY3VtZW50LmJvZHlbdF07Y2FzZSJzIjpyZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImh0bWwiKVswXS5zY3JvbGxUb3B8fDA7Y2FzZSJtIjpyZXR1cm4gd2luZG93LnNjcmVlblt0XTtjYXNlImMiOnJldHVybiB3aW5kb3cuZ29vZ2xlX3RhZ19kYXRhJiZ3aW5kb3cuZ29vZ2xlX3RhZ19kYXRhLmljcz9KU09OLnBhcnNlKGFHVE0uZi5zU3RyZih3aW5kb3cuZ29vZ2xlX3RhZ19kYXRhLmljcykpOm51bGw7Y2FzZSJwIjpyZXR1cm4ibm93Ij09dD9wZXJmb3JtYW5jZS5ub3coKTpwZXJmb3JtYW5jZVt0XTtkZWZhdWx0OnJldHVybn19LGFHVE0uZi5nZXROb2RlQXR0cj1mdW5jdGlvbihlLHQpe3ZhciBhPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZSk7cmV0dXJuIGE/YS5nZXRBdHRyaWJ1dGUodCk6bnVsbH0sYUdUTS5mLm5ld05vZGU9ZnVuY3Rpb24oZSx0LGEpe2lmKGFHVE0uZi52U3QoW2UsdF0pJiYib2JqZWN0Ij09dHlwZW9mIGEpe3ZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZSksbz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKHQpO2lmKG8pe2Zvcih2YXIgciBpbiBhKWlmKGEuaGFzT3duUHJvcGVydHkocikpe3ZhciBpPXIuc3BsaXQoIi4iKTsxPT09aS5sZW5ndGg/bi5zZXRBdHRyaWJ1dGUocixhW3JdKToobltpWzBdXXx8KG5baVswXV09e30pLG5baVswXV1baVsxXV09YVtyXSl9by5hcHBlbmRDaGlsZChuKX19fSxhR1RNLmYuZGVsTm9kZT1mdW5jdGlvbihlKXtpZihhR1RNLmYudlN0KGUpKXt2YXIgdD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUpO3QmJnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KX19LGFHVE0uZi5wYWdlaW5mbz1mdW5jdGlvbihlKXt2YXIgdD0wLGE9MDtpZigoZT1lfHx7fSkuY291bnRXb3JkcyYmZnVuY3Rpb24gZ2V0VGV4dChlKXtpZigzPT09ZS5ub2RlVHlwZSl0Kz1lLnRleHRDb250ZW50LnRyaW0oKS5zcGxpdCgvXHMrLykubGVuZ3RoO2Vsc2UgaWYoMT09PWUubm9kZVR5cGUmJiEvXihzY3JpcHR8c3R5bGV8bm9zY3JpcHQpJC9pLnRlc3QoZS50YWdOYW1lKSlmb3IodmFyIGE9MDthPGUuY2hpbGROb2Rlcy5sZW5ndGg7YSsrKWdldFRleHQoZS5jaGlsZE5vZGVzW2FdKX0oZG9jdW1lbnQuYm9keSksZS5jb3VudEltYWdlcylmb3IodmFyIG49ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImltZyIpLG89MDtvPG4ubGVuZ3RoO28rKyluW29dLm5hdHVyYWxXaWR0aD4yNTAmJm5bb10ubmF0dXJhbEhlaWdodD4yNTAmJmErKztyZXR1cm57d29yZHM6dCxpbWFnZXM6YX19LGFHVE0uZi5jcExzdD1mdW5jdGlvbihlLHQsYSl7dHJ5e2UuYWRkRXZlbnRMaXN0ZW5lcih0LChmdW5jdGlvbihlKXt2YXIgdDt3aW5kb3cuZ2V0U2VsZWN0aW9uJiYodD13aW5kb3cuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKSkmJmEodCl9KSl9Y2F0Y2godCl7YUdUTS5mLmxvZygiZTEyIix7ZWxlbWVudDplLGVycm9yOnR9KX19LGFHVE0uZi5lbExzdD1mdW5jdGlvbihlLHQsYSl7dHJ5e2UuYWRkRXZlbnRMaXN0ZW5lcih0LChmdW5jdGlvbihlKXtmb3IodmFyIHQ9dGhpcy50YWdOYW1lLnRvTG93ZXJDYXNlKCksbj0iIixvPSIiLHI9bnVsbCxpPW51bGwsYz0wLGY9dGhpcztmJiZmLnBhcmVudEVsZW1lbnQ7KWY9Zi5wYXJlbnRFbGVtZW50LCFuJiZmLmlkJiYobj0oInN0cmluZyI9PXR5cGVvZiBmLm5vZGVOYW1lP2Yubm9kZU5hbWUudG9Mb3dlckNhc2UoKSsiOiI6IiIpK2YuaWQpLCFvJiZmLmdldEF0dHJpYnV0ZSgiY2xhc3MiKSYmKG89KCJzdHJpbmciPT10eXBlb2YgZi5ub2RlTmFtZT9mLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkrIjoiOiIiKStmLmdldEF0dHJpYnV0ZSgiY2xhc3MiKSk7aWYoImlucHV0Ij09PXR8fCJzZWxlY3QiPT09dHx8InRleHRhcmVhIj09PXQpe2ZvcihmPXRoaXM7ZiYmZi5wYXJlbnRFbGVtZW50JiYiZm9ybSIhPT1mLnRhZ05hbWUudG9Mb3dlckNhc2UoKTspZj1mLnBhcmVudEVsZW1lbnQ7ImZvcm0iPT09Zi50YWdOYW1lLnRvTG93ZXJDYXNlKCkmJihyPXtpZDpmLmlkLGNsYXNzOmYuZ2V0QXR0cmlidXRlKCJjbGFzcyIpLG5hbWU6Zi5nZXRBdHRyaWJ1dGUoIm5hbWUiKSxhY3Rpb246Zi5hY3Rpb24sZWxlbWVudHM6Zi5lbGVtZW50cy5sZW5ndGh9LGk9QXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChmLmVsZW1lbnRzLHRoaXMpKzEpfSJvYmplY3QiPT10eXBlb2YgdGhpcy5lbGVtZW50cyYmIm51bWJlciI9PXR5cGVvZiB0aGlzLmVsZW1lbnRzLmxlbmd0aCYmKGM9dGhpcy5lbGVtZW50cy5sZW5ndGgpO3ZhciBzPXt0YWdOYW1lOnQsdGFyZ2V0OnRoaXMudGFyZ2V0fHwiIixwYXJlbnRJRDpuLHBhcmVudENsYXNzOm8saWQ6dGhpcy5pZHx8IiIsbmFtZTp0aGlzLmdldEF0dHJpYnV0ZSgibmFtZSIpfHwiIixjbGFzczp0aGlzLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIsaHJlZjp0aGlzLmhyZWZ8fCIiLHNyYzp0aGlzLnNyY3x8IiIsYWN0aW9uOnRoaXMuYWN0aW9ufHwiIix0eXBlOnRoaXMudHlwZXx8IiIsZWxlbWVudHM6Yyxwb3NpdGlvbjppLGZvcm06cixodG1sOnRoaXMub3V0ZXJIVE1MP3RoaXMub3V0ZXJIVE1MLnRvU3RyaW5nKCk6IiIsdGV4dDp0aGlzLm91dGVyVGV4dD90aGlzLm91dGVyVGV4dC50b1N0cmluZygpOiIifTtzLmh0bWwubGVuZ3RoPjUxMiYmKHMuaHRtbD1zLmh0bWwuc2xpY2UoMCw1MDkpKyIuLi4iKSxzLnRleHQubGVuZ3RoPjUxMiYmKHMudGV4dD1zLnRleHQuc2xpY2UoMCw1MDkpKyIuLi4iKSxhKHMpfSkpfWNhdGNoKHQpe2FHVE0uZi5sb2coImUxMiIse2VsZW1lbnQ6ZSxlcnJvcjp0fSl9fSxhR1RNLmYuYWRkRWxMc3Q9ZnVuY3Rpb24oZSx0LGEpe2lmKGFHVE0uZi52U3QoW2UsdF0pJiYiZnVuY3Rpb24iPT10eXBlb2YgYSl7dmFyIG49ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChlKTsib2JqZWN0Ij09dHlwZW9mIG4mJiJudW1iZXIiPT10eXBlb2Ygbi5sZW5ndGgmJjAhPW4ubGVuZ3RoJiZuLmZvckVhY2goKGZ1bmN0aW9uKGUpe2lmKCJjb3B5Ij09PXQpYUdUTS5mLmNwTHN0KGUsdCxhKTtlbHNlIGFHVE0uZi5lbExzdChlLHQsYSl9KSl9fSxhR1RNLmYub2JzZXJ2ZXI9ZnVuY3Rpb24oZSx0LGEpe2lmKGFHVE0uZi52U3QoW2UsdF0pJiYiZnVuY3Rpb24iPT10eXBlb2YgYSl7bmV3IE11dGF0aW9uT2JzZXJ2ZXIoKGZ1bmN0aW9uKG4pe24uZm9yRWFjaCgoZnVuY3Rpb24obil7ImNoaWxkTGlzdCI9PT1uLnR5cGUmJm4uYWRkZWROb2Rlcy5sZW5ndGgmJkFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobi5hZGRlZE5vZGVzLChmdW5jdGlvbihuKXtpZigxPT09bi5ub2RlVHlwZSYmInN0cmluZyI9PXR5cGVvZiBuLnRhZ05hbWUmJm4udGFnTmFtZS50b0xvd2VyQ2FzZSgpPT09ZS50b0xvd2VyQ2FzZSgpJiZhR1RNLmYuZWxMc3Qobix0LGEpLDE9PT1uLm5vZGVUeXBlJiZuLnF1ZXJ5U2VsZWN0b3JBbGwpe3ZhciBvPW4ucXVlcnlTZWxlY3RvckFsbChlLnRvTG93ZXJDYXNlKCkpO0FycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobywoZnVuY3Rpb24oZSl7YUdUTS5mLmVsTHN0KGUsdCxhKX0pKX19KSl9KSl9KSkub2JzZXJ2ZShkb2N1bWVudC5ib2R5LHtjaGlsZExpc3Q6ITAsc3VidHJlZTohMCxhdHRyaWJ1dGVzOiExfSl9fSxhR1RNLmYuclRlc3Q9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYUdUTS5mLnZTdChbZSx0XSkmJm5ldyBSZWdFeHAodCwiaSIpLnRlc3QoZSl9LGFHVE0uZi5yTWF0Y2g9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5tYXRjaChuZXcgUmVnRXhwKHQpKX0sYUdUTS5mLnJSZXBsYWNlPWZ1bmN0aW9uKGUsdCxhKXtyZXR1cm4gYUdUTS5mLnZTdChbZSx0LGFdKT9lLnJlcGxhY2UobmV3IFJlZ0V4cCh0LCJnaSIpLGEpOmV9LGFHVE0uZi5pc0lGcmFtZT1mdW5jdGlvbigpe3JldHVybiB3aW5kb3cuc2VsZiE9PXdpbmRvdy50b3B9LGFHVE0uZi5qc2Vycm9ycz1mdW5jdGlvbigpe2FHVE0uZi5ldkxzdG4od2luZG93LCJlcnJvciIsKGZ1bmN0aW9uKGUpe2lmKG51bGwhPT1lKXt2YXIgdD0ic3RyaW5nIj09dHlwZW9mIGUubWVzc2FnZT9lLm1lc3NhZ2U6IiIsYT0ic3RyaW5nIj09dHlwZW9mIGUuZmlsZW5hbWU/ZS5maWxlbmFtZToiIjtpZigic2NyaXB0IGVycm9yLiI9PXQudG9Mb3dlckNhc2UoKSl7aWYoIWEpcmV0dXJuO3Q9dC5yZXBsYWNlKCIuIiwiOiIpKyIgZXJyb3IgZnJvbSBvdGhlciBkb21haW4uIn1hJiYodCs9IiB8IGZpbGU6ICIrYSk7dmFyIG49YUdUTS5mLnN0cmNsZWFuKGUubGluZW5vKTsiMCI9PW4mJihuPSIiKSxuJiYodCs9IiB8IGxpbmU6ICIrbik7dmFyIG89YUdUTS5mLnN0cmNsZWFuKGUuY29sbm8pOyIwIj09byYmKG89IiIpLG8mJih0Kz0iIHwgY29sOiAiK28pLGFHVE0uZC5lcnJvcnMucHVzaCh0KTt2YXIgcj0iIjt0cnl7cj1uYXZpZ2F0b3IuYXBwQ29kZU5hbWUrIiB8ICIrbmF2aWdhdG9yLmFwcE5hbWUrIiB8ICIrbmF2aWdhdG9yLmFwcFZlcnNpb24rIiB8ICIrbmF2aWdhdG9yLnBsYXRmb3JtfWNhdGNoKGUpe31pZihhR1RNLmQuZXJyb3JfY291bnRlcisrPj0xMDApcmV0dXJuO2FHVE0uZC5lcnJvcl9jb3VudGVyPD01JiZhR1RNLmYuZmlyZSh7ZXZlbnQ6ImV4Y2VwdGlvbiIsZXJybXNnOnQsYnJvd3NlcjpyLGVycnR5cGU6IkpTIEVycm9yIix0aW1lc3RhbXA6KG5ldyBEYXRlKS5nZXRUaW1lKCksZXJyY3Q6YUdUTS5kLmVycm9yX2NvdW50ZXIsZXZlbnRNb2RlbDpudWxsfSl9fSkpfSxhR1RNLmYudGltZXJma3Q9ZnVuY3Rpb24oZSl7dmFyIHQ9SlNPTi5wYXJzZShhR1RNLmYuc1N0cmYoZSkpO3QudGltZXJfbXM9MSp0LnRpbWVyX21zLHQudGltZXJfY3QrKyx0LnRpbWVyX3RtPXQudGltZXJfbXMqdC50aW1lcl9jdCx0LnRpbWVyX3NjPXBhcnNlRmxvYXQoKHQudGltZXJfdG0vMWUzKS50b0ZpeGVkKDMpKSx0LmV2ZW50PXQuZXZlbnR8fCJ0aW1lciIsLTEhPT10LmV2ZW50LmluZGV4T2YoIltzXSIpJiYodC5ldmVudD10LmV2ZW50LnJlcGxhY2UoIltzXSIsdC50aW1lcl9zYy50b1N0cmluZygpKSksdC5ldmVudE1vZGVsPW51bGwsYUdUTS5mLmZpcmUodCl9LGFHVE0uZi50aW1lcj1mdW5jdGlvbihlLHQsYSxuLG8pe2lmKCFlJiYib2JqZWN0Ij09dHlwZW9mIGEmJmEmJiJzdHJpbmciPT10eXBlb2YgYS5ldmVudCYmKGU9YS5ldmVudCksZT1lfHwidGltZXIiLGUrPSJfIisobmV3IERhdGUpLmdldFRpbWUoKS50b1N0cmluZygpKyJfIitNYXRoLmZsb29yKDk5OTk5OSpNYXRoLnJhbmRvbSgpKzEpLnRvU3RyaW5nKCksYUdUTS5mLnN0b3B0aW1lcihlKSwib2JqZWN0Ij09dHlwZW9mIGEmJmEpdmFyIHI9SlNPTi5wYXJzZShhR1RNLmYuc1N0cmYoYSkpO2Vsc2Ugcj17fTtyLnRpbWVyX25tPWUsci50aW1lcl9tcz1uLHIudGltZXJfcnA9byxyLnRpbWVyX2N0PTAsci5pZD0xPT09ci50aW1lcl9ycD9zZXRUaW1lb3V0KChmdW5jdGlvbigpe3Q/dChyKTphR1RNLmYudGltZXJma3Qocil9KSxuKTpzZXRJbnRlcnZhbCgoZnVuY3Rpb24oKXt0P3Qocik6YUdUTS5mLnRpbWVyZmt0KHIpLHIudGltZXJfY3QrKyxyLnRpbWVyX3JwPjAmJnIudGltZXJfY3Q+PXIudGltZXJfcnAmJmFHVE0uZi5zdG9wdGltZXIoci50aW1lcl9ubSl9KSxuKSxhR1RNLmQudGltZXJbZV09cn0sYUdUTS5mLnN0b3B0aW1lcj1mdW5jdGlvbihlKXtpZigib2JqZWN0IiE9dHlwZW9mIGFHVE0uZC50aW1lciYmKGFHVE0uZC50aW1lcj17fSksIm9iamVjdCI9PXR5cGVvZiBhR1RNLmQudGltZXJbZV0pe3ZhciB0PWFHVE0uZC50aW1lcltlXTt0LnRpbWVyX3JwP2NsZWFySW50ZXJ2YWwodC5pZCk6Y2xlYXJUaW1lb3V0KHQuaWQpLGRlbGV0ZSBhR1RNLmQudGltZXJbZV19fSxhR1RNLmYuaW5pdD1mdW5jdGlvbigpeyFhR1RNLmMuZGVidWcmJmFHVE0uZi5vcHRvdXQoKXx8KGFHVE0uZi5jb25maWcoYUdUTS5jKSxhR1RNLmMuaWZyYW1lU3VwcG9ydCYmYUdUTS5kLmlzX2lmcmFtZT8oYUdUTS5kLmNvbnNlbnQuZ3RtQ29uc2VudD0hMCxhR1RNLmQuY29uc2VudC5oYXNSZXNwb25zZT0hMCxhR1RNLmQuY29uc2VudC5mZWVkYmFjaz0iUGFnZSBpcyBpRnJhbWUiLGFHVE0uZC5pZnJhbWUuaWZMaXN0ZW58fChhR1RNLmQuaWZyYW1lLmlmTGlzdGVuPSEwLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIixhR1RNLmYuaWZIU2xpc3RlbikpLGFHVE0uZC5pbml0fHxhR1RNLmYuaW5qZWN0KCkpOiJzdHJpbmciPT10eXBlb2YgYUdUTS5jLmNtcCYmYUdUTS5jLmNtcD8ibm9uZSI9PWFHVE0uYy5jbXA/KGFHVE0uZC5jb25zZW50PXtndG1Db25zZW50OiEwLGhhc1Jlc3BvbnNlOiEwLGZlZWRiYWNrOiJObyBDb25zZW50IENoZWNrIGNvbmZpZ3VyZWQifSxhR1RNLmYuaW5qZWN0KCkpOihhR1RNLmYubG9hZF9jYyhhR1RNLmMuY21wLGFHVE0uZi5jb25zZW50X2xpc3RlbmVyKSxhR1RNLmYuaW5pdEdUTSghMCkpOihhR1RNLmYuY29uc2VudF9saXN0ZW5lcigpLGFHVE0uZi5pbml0R1RNKCEwKSksYUdUTS5mLmpzZXJyb3JzKCkpfSxhR1RNLmYuc2VuZG5hdXM9ZnVuY3Rpb24oZSl7aWYoZSYmIm9iamVjdCI9PXR5cGVvZiBlKXt3aW5kb3dbYUdUTS5jLmdkbF07dmFyIHQ9d2luZG93W2FHVE0uYy5nZGxdLnB1c2g7IWFHVE0uZC5vcmlnaW5hbERMcHVzaCYmL3NhbmRib3gvaS50ZXN0KHQudG9TdHJpbmcoKSkmJihhR1RNLmQub3JpZ2luYWxETHB1c2g9dCk7dmFyIGE9ITE7YUdUTS5jLmRsT3JnUHVzaCYmYUdUTS5kLm9yaWdpbmFsRExwdXNoJiZhR1RNLmQub3JpZ2luYWxETHB1c2gudG9TdHJpbmcoKSE9PXQudG9TdHJpbmcoKSYmKGE9ITAsYUdUTS5kLmRsSG9va0xvZ2dlZHx8KGFHVE0uZC5vcmlnaW5hbERMcHVzaCh7ZXZlbnQ6ImV4Y2VwdGlvbiIsZXJydHlwZToiREwgRXJyb3IiLGVycm1zZzoiRnVuY3Rpb24gZGF0YUxheWVyLnB1c2ggaG9va2VkIC0gbm8gbG9uZ2VyIGZyb20gR1RNIixmY3RfaG9vazp0LnRvU3RyaW5nKCksZmN0X29yaWc6YUdUTS5kLm9yaWdpbmFsRExwdXNoLnRvU3RyaW5nKCksdGltZXN0YW1wOihuZXcgRGF0ZSkuZ2V0VGltZSgpLGV2ZW50TW9kZWw6bnVsbH0pLGFHVE0uZC5kbEhvb2tMb2dnZWQ9ITApLCJyZXBsYWNlIj09PWFHVE0uYy5kbE9yZ1B1c2gmJih3aW5kb3dbYUdUTS5jLmdkbF0ucHVzaD1hR1RNLmQub3JpZ2luYWxETHB1c2gsYT0hMSkpLGEmJiJ1c2UiPT09YUdUTS5jLmRsT3JnUHVzaD9hR1RNLmQub3JpZ2luYWxETHB1c2goZSk6d2luZG93W2FHVE0uYy5nZGxdLnB1c2goZSksImZ1bmN0aW9uIj09dHlwZW9mIGFHVE0uZi5zZW5kbmF1c19jYWxsYmFjayYmYUdUTS5mLnNlbmRuYXVzX2NhbGxiYWNrKGUpLGFHVE0uZi5sb2coIm05IixlKX19LGFHVE0uZi5maXJlPWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiPT10eXBlb2YgZSYmZSl7dHJ5e2lmKCEoYT1KU09OLnBhcnNlKGFHVE0uZi5zU3RyZihlKSkpKXJldHVybiB2b2lkIGFHVE0uZi5sb2coImUxNSIsYSl9Y2F0Y2gobil7dmFyIHQ9ImFHVE0gRmlyZSBFcnJvciAoSlNPTi5wYXJzZSkiOyJzdHJpbmciPT10eXBlb2YgZS5ldmVudCYmKHQ9dCsiIChFdmVudDogIitlLmV2ZW50KyIpIik7dmFyIGE9e2V2ZW50OiJleGNlcHRpb24iLGVycm1zZzpuLm1lc3NhZ2UsZXJydHlwZTp0LHRpbWVzdGFtcDoobmV3IERhdGUpLmdldFRpbWUoKSxlcnJjdDphR1RNLmQuZXJyb3JfY291bnRlcnx8MSxldmVudE1vZGVsOm51bGx9O2FHVE0uZi5sb2coImUxNSIsYSl9aWYoISgibnVtYmVyIj09dHlwZW9mIGEuYUdUTXRzfHwib2JqZWN0Ij09dHlwZW9mIGEuZXZlbnRNb2RlbCYmYS5ldmVudE1vZGVsfHwic3RyaW5nIiE9dHlwZW9mIGEuZXZlbnQmJiJzdHJpbmciPT10eXBlb2YgYS50eXBlJiYib2JqZWN0Ij09dHlwZW9mIGEuZmxhZ3MmJiJib29sZWFuIj09dHlwZW9mIGEuZmxhZ3MuZW5hYmxlVW50YWdnZWRQYWdlUmVwb3J0aW5nJiZhLmZsYWdzLmVuYWJsZVVudGFnZ2VkUGFnZVJlcG9ydGluZykpe2lmKGEuYUdUTXRzPURhdGUubm93KCksYS5ldmVudE1vZGVsPW51bGwsYUdUTS5jLmNvbnNlbnRfZXZlbnRzJiYic3RyaW5nIj09dHlwZW9mIGEuZXZlbnQmJmFHVE0uYy5jb25zZW50X2V2ZW50cy5pbmRleE9mKCIsIithLmV2ZW50KyIsIik+PTApaWYoIm9iamVjdCI9PXR5cGVvZiBhR1RNLmMuY29uc2VudF9ldmVudF9hdHRyW2EuZXZlbnRdKWZvcih2YXIgbiBpbiBhR1RNLmMuY29uc2VudF9ldmVudF9hdHRyW2EuZXZlbnRdKXZvaWQgMCE9PWFbbl0mJihhR1RNLmMuY29uc2VudF9ldmVudF9hdHRyW2EuZXZlbnRdW25dJiZhW25dIT1hR1RNLmMuY29uc2VudF9ldmVudF9hdHRyW2EuZXZlbnRdW25dfHxhR1RNLmYucnVuX2NjKCJ1cGRhdGUiKSk7ZWxzZSBhR1RNLmYucnVuX2NjKCJ1cGRhdGUiKTtpZihhR1RNLmMuZGxTZXQmJiJvYmplY3QiPT10eXBlb2YgZ29vZ2xlX3RhZ19tYW5hZ2VyJiYib2JqZWN0Ij09dHlwZW9mIGdvb2dsZV90YWdfbWFuYWdlclthR1RNLmMuZ3RtSURdJiZPYmplY3Qua2V5cyhhR1RNLmMuZGxTZXQpLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWFHVE0uYy5kbFNldFtlXSxuPWdvb2dsZV90YWdfbWFuYWdlclthR1RNLmMuZ3RtSURdW2FHVE0uYy5nZGxdLmdldCh0KTt2b2lkIDAhPT1uJiYoYVtlXT1uKX0pKSwoIm9iamVjdCIhPXR5cGVvZiBhR1RNLmQuY29uc2VudHx8IWFHVE0uZC5jb25zZW50Lmhhc1Jlc3BvbnNlfHwhYUdUTS5kLmNvbnNlbnQuZ3RtQ29uc2VudCkmJigic3RyaW5nIiE9dHlwZW9mIGEuZXZlbnR8fDAhPT1hLmV2ZW50LmluZGV4T2YoImFHVE0iKSl8fGFHVE0uYy5pZnJhbWVTdXBwb3J0JiZhR1RNLmQuaXNfaWZyYW1lJiYhYUdUTS5kLmlmcmFtZS5vcmlnaW4pcmV0dXJuIGRlbGV0ZSBhLmFHVE10cyxkZWxldGUgYS5ldmVudE1vZGVsLHZvaWQgYUdUTS5kLmYucHVzaChKU09OLnBhcnNlKGFHVE0uZi5zU3RyZihhKSkpOyhhR1RNLmQuY29uc2VudC5ndG1Db25zZW50fHwic3RyaW5nIj09dHlwZW9mIGEuZXZlbnQmJjA9PT1hLmV2ZW50LmluZGV4T2YoImFHVE0iKSkmJigic3RyaW5nIj09dHlwZW9mIGEuZXZlbnQmJjA9PT1hLmV2ZW50LmluZGV4T2YoImFHVE0iKXx8KGRlbGV0ZSBhWyJndG0udW5pcXVlRXZlbnRJZCJdLGRlbGV0ZSBhLmFHVE1wYXJhbXMsYS5hR1RNcGFyYW1zPUpTT04ucGFyc2UoYUdUTS5mLnNTdHJmKGEpKSksYUdUTS5kLmRsLnB1c2goYSksYUdUTS5jLmlmcmFtZVN1cHBvcnQmJmFHVE0uZC5pc19pZnJhbWUmJiJzdHJpbmciPT10eXBlb2YgYS5ldmVudD9hR1RNLmYuaUZyYW1lRmlyZShhKTphR1RNLmYuc2VuZG5hdXMoYSkpLCJmdW5jdGlvbiI9PXR5cGVvZiBhR1RNLmYuZmlyZV9jYWxsYmFjayYmYUdUTS5mLmZpcmVfY2FsbGJhY2soYSksYUdUTS5mLmxvZygibTciLGEpfX1lbHNlIGFHVE0uZi5sb2coImU5Iix7bzp0eXBlb2YgZX0pfTs=');

// Build JS Code for response
var jsCode = agtm + cmp + config + 'aGTM.f.init();';

// Response
setResponseStatus(200);
setResponseHeader(aGTMversion);
setResponseBody(jsCode);
returnResponse();


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_response",
        "versionId": "1"
      },
      "param": [
        {
          "key": "writeResponseAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "writeHeaderAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "queryParametersAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "pathAllowed",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "return_response",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Check JS Code
  code: |
    // Set Mocks
    //mock('setResponseStatus', 200);
    //mock('setResponseHeader', '1.2.2');
    //mock('setResponseBody', 'console.log("aGTM");');
    //mock('returnResponse');

    // Run Code
    runCode(mockData);

    // Checks
    //assertApi('setResponseStatus').wasCalledWith(200);
    //assertApi('setResponseHeader').wasCalled();
    //assertApi('setResponseBody').wasCalled();
    //assertApi('returnResponse').wasCalled();
setup: |-
  // Import needed libraries
  const log = require('logToConsole');

  // Setup MockData
  const mockData = {
    gtm: {
      gtm_id: 'GTM-XYZ123',
      gtm_consent: true,
      gtm_env: ''
    },
    cmp: null,
    consent: {
      gtmPurposes: 'Functional',
      gtmServices: 'Google Tag Manager',
      gtmVendors: 'Google Inc'
    },
    sendConsentEvent: true,
    useListener: false,
    consent_events: 'cmpEvent,cmpUpdate',
    vPageview: false,
    dlStateEvents: false,
    gdl: '',
    nonce: 'ABC123',
    debug: true
  };


___NOTES___

# aGTM serverside GTM Client Template

This is the aGTM Client Template to use it with the serverside Google Tag Manager.

Read more about aGTM in the <a href="https://github.com/Andiministrator/aGTM?tab=readme-ov-file#agtm---a-galactic-tagging-modulator">aGTM Documentation</a>.

Common Website integration code template:
```html
<script>
(function(w,d,s,u){
  var t=d.getElementsByTagName(s)[0],e=d.createElement(s);
  e.async=true;e.src=u;
  t.parentNode.insertBefore(e,t);
})(window,document,'script','https://TM.YOUR-DOMAIN.COM/aGTM.js');
</script>
```

Website integration code template using an ID:
```html
<script>
(function(w,d,s,u){
  var t=d.getElementsByTagName(s)[0],e=d.createElement(s);
  e.async=true;e.src=u;
  t.parentNode.insertBefore(e,t);
})(window,document,'script','https://TM.YOUR-DOMAIN.COM/aGTM.js?id=website1');
</script>
```


